/*
 * JsFCP v0.1.6
 * JavaScript BFCP client implementation using WebSocket as transport and JSON as message format
 * Copyright 2013-2015 eFace2Face, inc. All Rights Reserved
 */
!function(_){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=_();else if("function"==typeof define&&define.amd)define([],_);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.JsFCP=_()}}(function(){return function _(e,t,T){function A(o,s){if(!t[o]){if(!e[o]){var n="function"==typeof require&&require;if(!s&&n)return n(o,!0);if(r)return r(o,!0);var R=new Error("Cannot find module '"+o+"'");throw R.code="MODULE_NOT_FOUND",R}var E=t[o]={exports:{}};e[o][0].call(E.exports,function(_){var t=e[o][1][_];return A(t?t:_)},E,E.exports,_,e,t,T)}return t[o].exports}for(var r="function"==typeof require&&require,o=0;o<T.length;o++)A(T[o]);return A}({1:[function(_,e){e.exports={InvalidMessageFormatPrimitive:function(){var _=function(_){this.code=101,this.name="INVALID_MESSAGE_FORMAT_PRIMITIVE",this.message=" Message format error. Primitive doesn't exist. "+_};return _.prototype=new Error,_}(),InvalidMessageFormat:function(){var _=function(_){this.code=102,this.name="INVALID_MESSAGE_FORMAT",this.message=_};return _.prototype=new Error,_}(),InvalidHeaderFormat:function(){var _=function(_){this.code=103,this.name="INVALID_HEADER_FORMAT",this.message=_};return _.prototype=new Error,_}(),NoWebSocketException:function(){var _=function(){this.code=200,this.name="NO_WEBSOCKET_EXCEPTION",this.message="There is no WebSocket available"};return _.prototype=new Error,_}()}},{}],2:[function(_,e){function t(_){A.call(this),this.arrayFloorIds=_}e.exports=t;var T=_("debug")("JsFCP:FloorQuery"),A=_("events").EventEmitter,r=_("./MessageFactory");t.prototype=new A,t.prototype.onMessageReceived=function(_){if(_[r.C.HD_PRIMITIVE]===r.C.PRI_FL_STATUS_NAM){var e=_[r.C.HD_ATTRIBUTES],t=e[r.C.ATT_FL_ID_NAM];if(e[r.C.ATT_FLOOR_REQUEST_INFORMATION_NAM]){var A,o,s;for(A=e[r.C.ATT_FLOOR_REQUEST_INFORMATION_NAM].length,o=0;A>o;o++)if(s=e[r.C.ATT_FLOOR_REQUEST_INFORMATION_NAM][o],s[r.C.ATT_OVERALL_REQUEST_STATUS_NAM]){var n=s[r.C.ATT_FL_REQUEST_ID_NAM],R=s[r.C.ATT_OVERALL_REQUEST_STATUS_NAM][r.C.ATT_REQUEST_STATUS_NAM];if(R&&R[r.C.ATT_REQUEST_STATUS_VALUE_NAM]){var E=R[r.C.ATT_REQUEST_STATUS_VALUE_NAM];if(s[r.C.ATT_BENEFICIARY_INFORMATION_NAM]){var N=s[r.C.ATT_BENEFICIARY_INFORMATION_NAM][r.C.ATT_BENEFICIARY_ID_NAM];E===r.C.RS_GRANTED_NAM?this.emit("floorGranted",{floorId:t,beneficiaryId:N,floorRequestId:n}):(E===r.C.RS_RELEASED_NAM||E===r.C.RS_REVOKED_NAM)&&this.emit("floorReleased",{floorId:t,beneficiaryId:N,floorRequestId:n})}}}}}else T("onMessageReceived(): FloorStatus was expected");return null},t.prototype.onErrorReceived=function(_){T("onErrorReceived(): "+_)}},{"./MessageFactory":6,debug:10,events:9}],3:[function(_,e){function t(_,e,t){this.beneficiaryId=t,this.floorRequestId=e,this.onError=_.error}e.exports=t;var T=_("debug")("JsFCP:FloorRelease"),A=_("./MessageFactory");t.prototype.onMessageReceived=function(_){T("onMessageReceived(): this function shouldn't be called, but was called with: "+_)},t.prototype.onErrorReceived=function(_){T("onErrorReceived(): ",_);var e=_[A.C.HD_ATTRIBUTES][A.C.ATT_ERROR_CODE_NAM],t=_[A.C.HD_ATTRIBUTES][A.C.ATT_ERROR_INFO_NAM];void 0!==this.onError&&this.onError({errorCode:e,errorInfo:t})}},{"./MessageFactory":6,debug:10}],4:[function(_,e){function t(_,e){this.beneficiaryId=e,this.queuePosition=null,this.status=null,this.floorRequestId=null,this.statusInfo=null,this.onPending=_.pending,this.onAccepted=_.accepted,this.onGranted=_.granted,this.onDenied=_.denied,this.onCancelled=_.cancelled,this.onReleased=_.released,this.onRevoked=_.revoked,this.onError=_.error}function T(_,e){return null===_?!1:null===e?!0:e===_?!1:_===r.C.RS_GRANTED_NAM||_===r.C.RS_DENIED_NAM||_===r.C.RS_CANCELLED_NAM||_===r.C.RS_RELEASED_NAM||_===r.C.RS_REVOKED_NAM?!0:e===r.C.RS_GRANTED_NAM?!1:e===r.C.RS_PENDING_NAM&&_===r.C.RS_ACCEPTED_NAM?!0:e===r.C.RS_ACCEPTED_NAM?!1:void 0}e.exports=t;var A=_("debug")("JsFCP:FloorRequest"),r=_("./MessageFactory");t.prototype.onMessageReceived=function(_){if(_[r.C.HD_PRIMITIVE]===r.C.PRI_FL_REQUEST_STATUS_NAM){var e=_[r.C.HD_ATTRIBUTES][r.C.ATT_FLOOR_REQUEST_INFORMATION_NAM],t=_[r.C.HD_ATTRIBUTES][r.C.ATT_STATUS_INFO_NAM];if(e[r.C.ATT_OVERALL_REQUEST_STATUS_NAM]){var o=e[r.C.ATT_OVERALL_REQUEST_STATUS_NAM][r.C.ATT_REQUEST_STATUS_NAM];if(o){var s=o[r.C.ATT_REQUEST_STATUS_VALUE_NAM];if(s&&T(s,this.status)){if(t&&(this.statusInfo=t),this.status=o[r.C.ATT_REQUEST_STATUS_VALUE_NAM],o[r.C.ATT_QUEUE_POSITION_NAM]&&(this.queuePosition=o[r.C.ATT_QUEUE_POSITION_NAM]),this.floorRequestId=e[r.C.ATT_FL_REQUEST_ID_NAM],this.status===r.C.RS_PENDING_NAM)return A("onMessageReceived(): onPending ",this.floorRequestId),this.onPending(this),!0;if(this.status===r.C.RS_ACCEPTED_NAM)return A("onMessageReceived(): onAccepted ",this.floorRequestId),this.onAccepted(this),!0;if(this.status===r.C.RS_GRANTED_NAM)return A("onMessageReceived(): onGranted ",this.floorRequestId),this.onGranted(this),!0;if(this.status===r.C.RS_DENIED_NAM)return A("onMessageReceived(): onDenied ",this.floorRequestId),this.onDenied(),!1;if(this.status===r.C.RS_CANCELLED_NAM)return A("onMessageReceived(): onCancelled ",this.floorRequestId),this.onCancelled(),!1;if(this.status===r.C.RS_RELEASED_NAM)return A("onMessageReceived(): onReleased ",this.floorRequestId),this.onReleased(),!1;if(this.status===r.C.RS_REVOKED_NAM)return A("onMessageReceived(): onRevoked ",this.floorRequestId),this.onRevoked(),!1}}}}else A("onMessageReceived(): FloorRequestStatus was expected");return null},t.prototype.onErrorReceived=function(_){A("onErrorReceived(): "+_);var e=_[r.C.HD_ATTRIBUTES][r.C.ATT_ERROR_CODE_NAM],t=_[r.C.HD_ATTRIBUTES][r.C.ATT_ERROR_INFO_NAM];void 0!==this.onError&&this.onError({errorCode:e,errorInfo:t})}},{"./MessageFactory":6,debug:10}],5:[function(_,e){var t={Participant:_("./Participant"),Exceptions:_("./Exceptions"),debug:_("debug")};e.exports=t},{"./Exceptions":1,"./Participant":7,debug:10}],6:[function(_,e){function t(_,e){this.conferenceId=e,this.userId=_}function T(_,e,t){var N,I,a,M=[],S=t;if(o(_)&&(M=r(e),a=S.length,S=A(M,c[_],S),S.length!==a))return S;switch(_){case i.ATT_PRIORITY_NAM:s(e)||(I="checkJsfcpAttributeFormat(): attribute "+i.ATT_PRIORITY_NAM+', "'+e+'" is not a valid value',E(I),S.push(I));break;case i.ATT_REQUEST_STATUS_NAM:var u=e[i.ATT_REQUEST_STATUS_VALUE_NAM];u&&"undefined"!==u||(I="checkJsfcpAttributeFormat(): attribute "+i.ATT_REQUEST_STATUS_NAM+", "+i.ATT_REQUEST_STATUS_VALUE_NAM+" was found",E(I),S.push(I)),n(u)||(I="checkJsfcpAttributeFormat(): attribute "+i.ATT_REQUEST_STATUS_NAM+', "'+u+'" is not a valid value',E(I),S.push(I));break;case i.ATT_ERROR_CODE_NAM:R(e)||(I="checkJsfcpAttributeFormat(): attribute "+i.ATT_ERROR_CODE_NAM+', "'+e+'" is not a valid value for attribute '+i.ATT_ERROR_CODE_NAM,E(I),S.push(I));break;case i.ATT_FLOOR_REQUEST_INFORMATION_NAM:N=M.indexOf(i.ATT_FL_REQUEST_ID_NAM),0>N&&(I="checkJsfcpAttributeFormat(): Attribute "+i.ATT_FLOOR_REQUEST_INFORMATION_NAM+", no "+i.ATT_FL_REQUEST_ID_NAM+" was found",E(I),S.push(I)),M.indexOf(i.ATT_FL_REQUEST_STATUS_NAM)<0?(I="checkJsfcpAttributeFormat(): attribute "+i.ATT_FLOOR_REQUEST_INFORMATION_NAM+", no "+i.ATT_FL_REQUEST_STATUS_NAM+" was found",E(I),S.push(I)):e[i.ATT_FL_REQUEST_STATUS_NAM]instanceof Array||(I="checkJsfcpAttributeFormat(): attribute "+i.ATT_FLOOR_REQUEST_INFORMATION_NAM+", "+i.ATT_FL_REQUEST_STATUS_NAM+" should be an array",E(I),S.push(I));break;case i.ATT_OVERALL_REQUEST_STATUS_NAM:N=M.indexOf(i.ATT_FL_REQUEST_ID_NAM),0>N&&(I="checkJsfcpAttributeFormat(): attribute "+i.ATT_OVERALL_REQUEST_STATUS_NAM+", no "+i.ATT_FL_REQUEST_ID_NAM+" was found",E(I),S.push(I));break;case i.ATT_FL_REQUEST_STATUS_NAM:N=M.indexOf(i.ATT_FL_ID_NAM),0>N&&(I="checkJsfcpAttributeFormat(): attribute "+i.ATT_FL_REQUEST_STATUS_NAM+", no "+i.ATT_FL_ID_NAM+" was found",E(I),S.push(I));break;case i.ATT_BENEFICIARY_INFORMATION_NAM:N=M.indexOf(i.ATT_BENEFICIARY_ID_NAM),0>N&&(I="checkJsfcpAttributeFormat(): attribute "+i.ATT_BENEFICIARY_INFORMATION_NAM+", no "+i.ATT_BENEFICIARY_ID_NAM+" was found",E(I),S.push(I));break;case i.ATT_REQUESTED_BY_INFORMATION_NAM:N=M.indexOf(i.ATT_REQUESTED_BY_ID_NAM),0>N&&(I="checkJsfcpAttributeFormat(): attribute "+i.ATT_REQUESTED_BY_INFORMATION_NAM+", no "+i.ATT_REQUESTED_BY_ID_NAM+" was found",E(I),S.push(I))}return a=S.length,M.forEach(function(_){if(o(_)||_===i.ATT_PRIORITY_NAM)if(e[_]instanceof Array)for(var t=e[_].length,A=0;t>A;A++)S=T(_,e[_][A],S);else if(S=T(_,e[_],S),S.length!==a)return S}),S}function A(_,e,t){for(var T,A=_.length,r=t,o=0;A>o;o++){var s=e.indexOf(_[o]);0>s&&(T="checkValidAttributes(): attribute list ["+_+"], invalid attribute list because of ["+_[o]+"]",E(T),r.push(T))}return r}function r(_){var e=[];for(var t in _)e.push(t);return e}function o(_){return c[_]?!0:!1}function s(_){return a.indexOf(_)>=0?!0:!1}function n(_){return M.indexOf(_)>=0?!0:!1}function R(_){return S.indexOf(_)>=0?!0:!1}e.exports=t;var E=_("debug")("JsFCP:MessageFactory"),N=_("./Exceptions"),i={CNF_OPTIONAL:"optional",CNF_MULTI:"multiple",HD_VER:"ver",HD_VER_1:1,HD_PRIMITIVE:"primitive",HD_CONFERENCE_ID:"conferenceId",HD_TRANSACTION_ID:"transactionId",HD_USER_ID:"userId",HD_HEADER:"header",HD_ATTRIBUTES:"attributes",PRI_FL_REQUEST_NAM:"FloorRequest",PRI_FL_REQUEST_VAL:1,PRI_FL_RELEASE_NAM:"FloorRelease",PRI_FL_RELEASE_VAL:2,PRI_FL_REQUEST_QUERY_NAM:"FloorRequestQuery",PRI_FL_REQUEST_QUERY_VAL:3,PRI_FL_REQUEST_STATUS_NAM:"FloorRequestStatus",PRI_FL_REQUEST_STATUS_VAL:4,PRI_FL_USER_QUERY_NAM:"UserQuery",PRI_FL_USER_QUERY_VAL:5,PRI_FL_USER_STATUS_NAM:"UserStatus",PRI_FL_USER_STATUS_VAL:6,PRI_FL_QUERY_NAM:"FloorQuery",PRI_FL_QUERY_VAL:7,PRI_FL_STATUS_NAM:"FloorStatus",PRI_FL_STATUS_VAL:8,PRI_CH_ACTION_NAM:"ChairAction",PRI_CH_ACTION_VAL:9,PRI_CH_ACTION_ACK_NAM:"ChairActionAck",PRI_CH_ACTION_ACK_VAL:10,PRI_HELLO_NAM:"Hello",PRI_HELLO_VAL:11,PRI_HELLO_ACK_NAM:"HelloAck",PRI_HELLO_ACK_VAL:12,PRI_ERROR_NAM:"Error",PRI_ERROR_VAL:13,ATT_BENEFICIARY_ID_NAM:"beneficiaryId",ATT_BENEFICIARY_ID_VAL:1,ATT_FL_ID_NAM:"floorId",ATT_FL_ID_VAL:2,ATT_FL_REQUEST_ID_NAM:"floorRequestId",ATT_FL_REQUEST_ID_VAL:3,ATT_PRIORITY_NAM:"priority",ATT_PRIORITY_VAL:4,ATT_REQUEST_STATUS_NAM:"requestStatus",ATT_REQUEST_STATUS_VAL:5,ATT_ERROR_CODE_NAM:"errorCode",ATT_ERROR_CODE_VAL:6,ATT_ERROR_INFO_NAM:"errorInfo",ATT_ERROR_INFO_VAL:7,ATT_PARTICIPANT_PROVIDED_INFO_NAM:"participantProvidedInfo",ATT_PARTICIPANT_PROVIDED_INFO_VAL:8,ATT_STATUS_INFO_NAM:"statusInfo",ATT_STATUS_INFO_VAL:9,ATT_SUPPORTED_ATTRIBUTES_NAM:"supportedAttributes",ATT_SUPPORTED_ATTRIBUTES_VAL:10,ATT_SUPPORTED_PRIMITIVES_NAM:"supportedPrimitives",ATT_SUPPORTED_PRIMITIVES_VAL:11,ATT_USER_DISPLAY_NAME_NAM:"userDisplayName",ATT_USER_DISPLAY_NAME_VAL:12,ATT_USER_URI_NAM:"userUri",ATT_USER_URI_VAL:13,ATT_BENEFICIARY_INFORMATION_NAM:"beneficiaryInformation",ATT_BENEFICIARY_INFORMATION_VAL:14,ATT_FLOOR_REQUEST_INFORMATION_NAM:"floorRequestInformation",ATT_FLOOR_REQUEST_INFORMATION_VAL:15,ATT_REQUESTED_BY_INFORMATION_NAM:"requestedByInformation",ATT_REQUESTED_BY_INFORMATION_VAL:16,ATT_FL_REQUEST_STATUS_NAM:"floorRequestStatus",ATT_FL_REQUEST_STATUS_VAL:17,ATT_OVERALL_REQUEST_STATUS_NAM:"overallRequestStatus",ATT_OVERALL_REQUEST_STATUS_VAL:18,ATT_REQUESTED_BY_ID_NAM:"requestedById",ATT_REQUESTED_BY_ID_VAL:19,ATT_EXTENSION_ATTRIBUTE_NAM:"extensionAttribute",ATT_EXTENSION_ATTRIBUTE_VAL:20,ATT_REQUEST_STATUS_VALUE_NAM:"status",ATT_REQUEST_STATUS_VALUE_VAL:21,ATT_QUEUE_POSITION_NAM:"queuePosition",ATT_QUEUE_POSITION_VAL:22,ATT_SUPPORTED_FLOORTYPES_NAM:"supportedFloorTypes",ATT_SUPPORTED_FLOORTYPES_VAL:23,PR_LOWEST_NAM:"Lowest",PR_LOWEST_VAL:0,PR_LOW_NAM:"Low",PR_LOW_VAL:1,PR_NORMAL_NAM:"Normal",PR_NORMAL_VAL:2,PR_HIGH_NAM:"High",PR_HIGH_VAL:3,PR_HIGHEST_NAM:"Highest",PR_HIGHEST_VAL:4,RS_PENDING_NAM:"Pending",RS_PENDING_VAL:1,RS_ACCEPTED_NAM:"Accepted",RS_ACCEPTED_VAL:2,RS_GRANTED_NAM:"Granted",RS_GRANTED_VAL:3,RS_DENIED_NAM:"Denied",RS_DENIED_VAL:4,RS_CANCELLED_NAM:"Cancelled",RS_CANCELLED_VAL:5,RS_RELEASED_NAM:"Released",RS_RELEASED_VAL:6,RS_REVOKED_NAM:"Revoked",RS_REVOKED_VAL:7,ERR_NO_CONF_NAM:"ErrorConferenceDoesNotExist",ERR_NO_CONF_VAL:1,ERR_NO_USER_NAM:"UserDoesNotExist",ERR_NO_USER_VAL:2,ERR_UNK_PR_NAM:"UnknownPrimitive",ERR_UNK_PR_VAL:3,ERR_UNK_ATT_NAM:"UnknownMandatoryAttribute",ERR_UNK_ATT_VAL:4,ERR_UNAUTH_OP_NAM:"UnauthorizedOperation",ERR_UNAUTH_OP_VAL:5,ERR_INV_FL_ID_NAM:"InvalidFloorId",ERR_INV_FL_ID_VAL:6,ERR_NO_FL_RQ_ID_NAM:"FloorRequestIdDoesNotExist",ERR_NO_FL_RQ_ID_VAL:7,ERR_MAX_FL_RQ_NAM:"FloorRequestMaxNumberReached",ERR_MAX_FL_RQ_VAL:8,ERR_TLS_NAM:"UseTls",ERR_TLS_VAL:9};t.C=i;var I=[i.PRI_FL_REQUEST_NAM,i.PRI_FL_RELEASE_NAM,i.PRI_FL_REQUEST_QUERY_NAM,i.PRI_FL_REQUEST_STATUS_NAM,i.PRI_FL_USER_QUERY_NAM,i.PRI_FL_USER_STATUS_NAM,i.PRI_FL_QUERY_NAM,i.PRI_FL_STATUS_NAM,i.PRI_CH_ACTION_NAM,i.PRI_CH_ACTION_ACK_NAM,i.PRI_HELLO_NAM,i.PRI_HELLO_ACK_NAM,i.PRI_ERROR_NAM],a=[i.PR_LOWEST_NAM,i.PR_LOW_NAM,i.PR_NORMAL_NAM,i.PR_HIGH_NAM,i.PR_HIGHEST_NAM],M=[i.RS_PENDING_NAM,i.RS_ACCEPTED_NAM,i.RS_GRANTED_NAM,i.RS_DENIED_NAM,i.RS_CANCELLED_NAM,i.RS_RELEASED_NAM,i.RS_REVOKED_NAM],S=[i.ERR_NO_CONF_NAM,i.ERR_NO_USER_NAM,i.ERR_UNK_PR_NAM,i.ERR_UNK_ATT_NAM,i.ERR_UNAUTH_OP_NAM,i.ERR_INV_FL_ID_NAM,i.ERR_NO_FL_RQ_ID_NAM,i.ERR_MAX_FL_RQ_NAM,i.ERR_TLS_NAM],c={};c[i.ATT_BENEFICIARY_INFORMATION_NAM]=[i.ATT_BENEFICIARY_ID_NAM,i.ATT_USER_DISPLAY_NAME_NAM,i.ATT_USER_URI_NAM,i.ATT_EXTENSION_ATTRIBUTE_NAM],c[i.ATT_FLOOR_REQUEST_INFORMATION_NAM]=[i.ATT_FL_REQUEST_ID_NAM,i.ATT_OVERALL_REQUEST_STATUS_NAM,i.ATT_FL_REQUEST_STATUS_NAM,i.ATT_BENEFICIARY_INFORMATION_NAM,i.ATT_REQUESTED_BY_INFORMATION_NAM,i.ATT_PRIORITY_NAM,i.ATT_PARTICIPANT_PROVIDED_INFO_NAM,i.ATT_EXTENSION_ATTRIBUTE_NAM],c[i.ATT_REQUESTED_BY_INFORMATION_NAM]=[i.ATT_REQUESTED_BY_ID_NAM,i.ATT_USER_DISPLAY_NAME_NAM,i.ATT_USER_URI_NAM,i.ATT_EXTENSION_ATTRIBUTE_NAM],c[i.ATT_FL_REQUEST_STATUS_NAM]=[i.ATT_FL_ID_NAM,i.ATT_REQUEST_STATUS_NAM,i.ATT_STATUS_INFO_NAM,i.ATT_EXTENSION_ATTRIBUTE_NAM],c[i.ATT_OVERALL_REQUEST_STATUS_NAM]=[i.ATT_FL_REQUEST_ID_NAM,i.ATT_REQUEST_STATUS_NAM,i.ATT_STATUS_INFO_NAM,i.ATT_EXTENSION_ATTRIBUTE_NAM],c[i.ATT_REQUEST_STATUS_NAM]=[i.ATT_REQUEST_STATUS_VALUE_NAM,i.ATT_QUEUE_POSITION_NAM];var u=[i.HD_VER,i.HD_PRIMITIVE,i.HD_CONFERENCE_ID,i.HD_TRANSACTION_ID,i.HD_USER_ID,i.HD_ATTRIBUTES],O={};O[i.PRI_FL_REQUEST_NAM]={},O[i.PRI_FL_REQUEST_NAM][i.ATT_FL_ID_NAM]={},O[i.PRI_FL_REQUEST_NAM][i.ATT_FL_ID_NAM][i.CNF_OPTIONAL]=0,O[i.PRI_FL_REQUEST_NAM][i.ATT_FL_ID_NAM][i.CNF_MULTI]=1,O[i.PRI_FL_REQUEST_NAM][i.ATT_BENEFICIARY_ID_NAM]={},O[i.PRI_FL_REQUEST_NAM][i.ATT_BENEFICIARY_ID_NAM][i.CNF_OPTIONAL]=1,O[i.PRI_FL_REQUEST_NAM][i.ATT_BENEFICIARY_ID_NAM][i.CNF_MULTI]=0,O[i.PRI_FL_REQUEST_NAM][i.ATT_PARTICIPANT_PROVIDED_INFO_NAM]={},O[i.PRI_FL_REQUEST_NAM][i.ATT_PARTICIPANT_PROVIDED_INFO_NAM][i.CNF_OPTIONAL]=1,O[i.PRI_FL_REQUEST_NAM][i.ATT_PARTICIPANT_PROVIDED_INFO_NAM][i.CNF_MULTI]=0,O[i.PRI_FL_REQUEST_NAM][i.ATT_PRIORITY_NAM]={},O[i.PRI_FL_REQUEST_NAM][i.ATT_PRIORITY_NAM][i.CNF_OPTIONAL]=1,O[i.PRI_FL_REQUEST_NAM][i.ATT_PRIORITY_NAM][i.CNF_MULTI]=0,O[i.PRI_FL_REQUEST_NAM][i.ATT_EXTENSION_ATTRIBUTE_NAM]={},O[i.PRI_FL_REQUEST_NAM][i.ATT_EXTENSION_ATTRIBUTE_NAM][i.CNF_OPTIONAL]=1,O[i.PRI_FL_REQUEST_NAM][i.ATT_EXTENSION_ATTRIBUTE_NAM][i.CNF_MULTI]=1,O[i.PRI_FL_REQUEST_NAM]={},O[i.PRI_FL_REQUEST_NAM][i.ATT_FL_ID_NAM]={},O[i.PRI_FL_REQUEST_NAM][i.ATT_FL_ID_NAM][i.CNF_OPTIONAL]=0,O[i.PRI_FL_REQUEST_NAM][i.ATT_FL_ID_NAM][i.CNF_MULTI]=1,O[i.PRI_FL_REQUEST_NAM][i.ATT_BENEFICIARY_ID_NAM]={},O[i.PRI_FL_REQUEST_NAM][i.ATT_BENEFICIARY_ID_NAM][i.CNF_OPTIONAL]=1,O[i.PRI_FL_REQUEST_NAM][i.ATT_BENEFICIARY_ID_NAM][i.CNF_MULTI]=0,O[i.PRI_FL_REQUEST_NAM][i.ATT_PARTICIPANT_PROVIDED_INFO_NAM]={},O[i.PRI_FL_REQUEST_NAM][i.ATT_PARTICIPANT_PROVIDED_INFO_NAM][i.CNF_OPTIONAL]=1,O[i.PRI_FL_REQUEST_NAM][i.ATT_PARTICIPANT_PROVIDED_INFO_NAM][i.CNF_MULTI]=0,O[i.PRI_FL_REQUEST_NAM][i.ATT_PRIORITY_NAM]={},O[i.PRI_FL_REQUEST_NAM][i.ATT_PRIORITY_NAM][i.CNF_OPTIONAL]=1,O[i.PRI_FL_REQUEST_NAM][i.ATT_PRIORITY_NAM][i.CNF_MULTI]=0,O[i.PRI_FL_REQUEST_NAM][i.ATT_EXTENSION_ATTRIBUTE_NAM]={},O[i.PRI_FL_REQUEST_NAM][i.ATT_EXTENSION_ATTRIBUTE_NAM][i.CNF_OPTIONAL]=1,O[i.PRI_FL_REQUEST_NAM][i.ATT_EXTENSION_ATTRIBUTE_NAM][i.CNF_MULTI]=1,O[i.PRI_FL_RELEASE_NAM]={},O[i.PRI_FL_RELEASE_NAM][i.ATT_FL_REQUEST_ID_NAM]={},O[i.PRI_FL_RELEASE_NAM][i.ATT_FL_REQUEST_ID_NAM][i.CNF_OPTIONAL]=0,O[i.PRI_FL_RELEASE_NAM][i.ATT_FL_REQUEST_ID_NAM][i.CNF_MULTI]=0,O[i.PRI_FL_RELEASE_NAM][i.ATT_EXTENSION_ATTRIBUTE_NAM]={},O[i.PRI_FL_RELEASE_NAM][i.ATT_EXTENSION_ATTRIBUTE_NAM][i.CNF_OPTIONAL]=1,O[i.PRI_FL_RELEASE_NAM][i.ATT_EXTENSION_ATTRIBUTE_NAM][i.CNF_MULTI]=1,O[i.PRI_FL_REQUEST_QUERY_NAM]={},O[i.PRI_FL_REQUEST_QUERY_NAM][i.ATT_FL_REQUEST_ID_NAM]={},O[i.PRI_FL_REQUEST_QUERY_NAM][i.ATT_FL_REQUEST_ID_NAM][i.CNF_OPTIONAL]=0,O[i.PRI_FL_REQUEST_QUERY_NAM][i.ATT_FL_REQUEST_ID_NAM][i.CNF_MULTI]=0,O[i.PRI_FL_REQUEST_QUERY_NAM][i.ATT_EXTENSION_ATTRIBUTE_NAM]={},O[i.PRI_FL_REQUEST_QUERY_NAM][i.ATT_EXTENSION_ATTRIBUTE_NAM][i.CNF_OPTIONAL]=1,O[i.PRI_FL_REQUEST_QUERY_NAM][i.ATT_EXTENSION_ATTRIBUTE_NAM][i.CNF_MULTI]=1,O[i.PRI_FL_REQUEST_STATUS_NAM]={},O[i.PRI_FL_REQUEST_STATUS_NAM][i.ATT_FLOOR_REQUEST_INFORMATION_NAM]={},O[i.PRI_FL_REQUEST_STATUS_NAM][i.ATT_FLOOR_REQUEST_INFORMATION_NAM][i.CNF_OPTIONAL]=0,O[i.PRI_FL_REQUEST_STATUS_NAM][i.ATT_FLOOR_REQUEST_INFORMATION_NAM][i.CNF_MULTI]=0,O[i.PRI_FL_REQUEST_STATUS_NAM][i.ATT_EXTENSION_ATTRIBUTE_NAM]={},O[i.PRI_FL_REQUEST_STATUS_NAM][i.ATT_EXTENSION_ATTRIBUTE_NAM][i.CNF_OPTIONAL]=1,O[i.PRI_FL_REQUEST_STATUS_NAM][i.ATT_EXTENSION_ATTRIBUTE_NAM][i.CNF_MULTI]=1,O[i.PRI_FL_USER_QUERY_NAM]={},O[i.PRI_FL_USER_QUERY_NAM][i.ATT_BENEFICIARY_ID_NAM]={},O[i.PRI_FL_USER_QUERY_NAM][i.ATT_BENEFICIARY_ID_NAM][i.CNF_OPTIONAL]=1,O[i.PRI_FL_USER_QUERY_NAM][i.ATT_BENEFICIARY_ID_NAM][i.CNF_MULTI]=0,O[i.PRI_FL_USER_QUERY_NAM][i.ATT_EXTENSION_ATTRIBUTE_NAM]={},O[i.PRI_FL_USER_QUERY_NAM][i.ATT_EXTENSION_ATTRIBUTE_NAM][i.CNF_OPTIONAL]=1,O[i.PRI_FL_USER_QUERY_NAM][i.ATT_EXTENSION_ATTRIBUTE_NAM][i.CNF_MULTI]=1,O[i.PRI_FL_USER_STATUS_NAM]={},O[i.PRI_FL_USER_STATUS_NAM][i.ATT_BENEFICIARY_INFORMATION_NAM]={},O[i.PRI_FL_USER_STATUS_NAM][i.ATT_BENEFICIARY_INFORMATION_NAM][i.CNF_OPTIONAL]=1,O[i.PRI_FL_USER_STATUS_NAM][i.ATT_BENEFICIARY_INFORMATION_NAM][i.CNF_MULTI]=0,O[i.PRI_FL_USER_STATUS_NAM][i.ATT_FLOOR_REQUEST_INFORMATION_NAM]={},O[i.PRI_FL_USER_STATUS_NAM][i.ATT_FLOOR_REQUEST_INFORMATION_NAM][i.CNF_OPTIONAL]=0,O[i.PRI_FL_USER_STATUS_NAM][i.ATT_FLOOR_REQUEST_INFORMATION_NAM][i.CNF_MULTI]=1,O[i.PRI_FL_USER_STATUS_NAM][i.ATT_EXTENSION_ATTRIBUTE_NAM]={},O[i.PRI_FL_USER_STATUS_NAM][i.ATT_EXTENSION_ATTRIBUTE_NAM][i.CNF_OPTIONAL]=1,O[i.PRI_FL_USER_STATUS_NAM][i.ATT_EXTENSION_ATTRIBUTE_NAM][i.CNF_MULTI]=1,O[i.PRI_FL_QUERY_NAM]={},O[i.PRI_FL_QUERY_NAM][i.ATT_FL_ID_NAM]={},O[i.PRI_FL_QUERY_NAM][i.ATT_FL_ID_NAM][i.CNF_OPTIONAL]=0,O[i.PRI_FL_QUERY_NAM][i.ATT_FL_ID_NAM][i.CNF_MULTI]=1,O[i.PRI_FL_QUERY_NAM][i.ATT_EXTENSION_ATTRIBUTE_NAM]={},O[i.PRI_FL_QUERY_NAM][i.ATT_EXTENSION_ATTRIBUTE_NAM][i.CNF_OPTIONAL]=1,O[i.PRI_FL_QUERY_NAM][i.ATT_EXTENSION_ATTRIBUTE_NAM][i.CNF_MULTI]=1,O[i.PRI_FL_STATUS_NAM]={},O[i.PRI_FL_STATUS_NAM][i.ATT_FL_ID_NAM]={},O[i.PRI_FL_STATUS_NAM][i.ATT_FL_ID_NAM][i.CNF_OPTIONAL]=0,O[i.PRI_FL_STATUS_NAM][i.ATT_FL_ID_NAM][i.CNF_MULTI]=0,O[i.PRI_FL_STATUS_NAM][i.ATT_FLOOR_REQUEST_INFORMATION_NAM]={},O[i.PRI_FL_STATUS_NAM][i.ATT_FLOOR_REQUEST_INFORMATION_NAM][i.CNF_OPTIONAL]=1,O[i.PRI_FL_STATUS_NAM][i.ATT_FLOOR_REQUEST_INFORMATION_NAM][i.CNF_MULTI]=1,O[i.PRI_FL_STATUS_NAM][i.ATT_EXTENSION_ATTRIBUTE_NAM]={},O[i.PRI_FL_STATUS_NAM][i.ATT_EXTENSION_ATTRIBUTE_NAM][i.CNF_OPTIONAL]=1,O[i.PRI_FL_STATUS_NAM][i.ATT_EXTENSION_ATTRIBUTE_NAM][i.CNF_MULTI]=1,O[i.PRI_CH_ACTION_NAM]={},O[i.PRI_CH_ACTION_NAM][i.ATT_FLOOR_REQUEST_INFORMATION_NAM]={},O[i.PRI_CH_ACTION_NAM][i.ATT_FLOOR_REQUEST_INFORMATION_NAM][i.CNF_OPTIONAL]=0,O[i.PRI_CH_ACTION_NAM][i.ATT_FLOOR_REQUEST_INFORMATION_NAM][i.CNF_MULTI]=0,O[i.PRI_HELLO_NAM]={},O[i.PRI_HELLO_NAM][i.ATT_EXTENSION_ATTRIBUTE_NAM]={},O[i.PRI_HELLO_NAM][i.ATT_EXTENSION_ATTRIBUTE_NAM][i.CNF_OPTIONAL]=1,O[i.PRI_HELLO_NAM][i.ATT_EXTENSION_ATTRIBUTE_NAM][i.CNF_MULTI]=1,O[i.PRI_CH_ACTION_ACK_NAM]={},O[i.PRI_CH_ACTION_ACK_NAM][i.ATT_EXTENSION_ATTRIBUTE_NAM]={},O[i.PRI_CH_ACTION_ACK_NAM][i.ATT_EXTENSION_ATTRIBUTE_NAM][i.CNF_OPTIONAL]=1,O[i.PRI_CH_ACTION_ACK_NAM][i.ATT_EXTENSION_ATTRIBUTE_NAM][i.CNF_MULTI]=1,O[i.PRI_HELLO_NAM]={},O[i.PRI_HELLO_NAM][i.ATT_EXTENSION_ATTRIBUTE_NAM]={},O[i.PRI_HELLO_NAM][i.ATT_EXTENSION_ATTRIBUTE_NAM][i.CNF_OPTIONAL]=1,O[i.PRI_HELLO_NAM][i.ATT_EXTENSION_ATTRIBUTE_NAM][i.CNF_MULTI]=1,O[i.PRI_HELLO_ACK_NAM]={},O[i.PRI_HELLO_ACK_NAM][i.ATT_SUPPORTED_PRIMITIVES_NAM]={},O[i.PRI_HELLO_ACK_NAM][i.ATT_SUPPORTED_PRIMITIVES_NAM][i.CNF_OPTIONAL]=0,O[i.PRI_HELLO_ACK_NAM][i.ATT_SUPPORTED_PRIMITIVES_NAM][i.CNF_MULTI]=1,O[i.PRI_HELLO_ACK_NAM][i.ATT_SUPPORTED_ATTRIBUTES_NAM]={},O[i.PRI_HELLO_ACK_NAM][i.ATT_SUPPORTED_ATTRIBUTES_NAM][i.CNF_OPTIONAL]=0,O[i.PRI_HELLO_ACK_NAM][i.ATT_SUPPORTED_ATTRIBUTES_NAM][i.CNF_MULTI]=1,O[i.PRI_HELLO_ACK_NAM][i.ATT_SUPPORTED_FLOORTYPES_NAM]={},O[i.PRI_HELLO_ACK_NAM][i.ATT_SUPPORTED_FLOORTYPES_NAM][i.CNF_OPTIONAL]=1,O[i.PRI_HELLO_ACK_NAM][i.ATT_SUPPORTED_FLOORTYPES_NAM][i.CNF_MULTI]=1,O[i.PRI_HELLO_ACK_NAM][i.ATT_EXTENSION_ATTRIBUTE_NAM]={},O[i.PRI_HELLO_ACK_NAM][i.ATT_EXTENSION_ATTRIBUTE_NAM][i.CNF_OPTIONAL]=1,O[i.PRI_HELLO_ACK_NAM][i.ATT_EXTENSION_ATTRIBUTE_NAM][i.CNF_MULTI]=1,O[i.PRI_ERROR_NAM]={},O[i.PRI_ERROR_NAM][i.ATT_ERROR_CODE_NAM]={},O[i.PRI_ERROR_NAM][i.ATT_ERROR_CODE_NAM][i.CNF_OPTIONAL]=0,O[i.PRI_ERROR_NAM][i.ATT_ERROR_CODE_NAM][i.CNF_MULTI]=0,O[i.PRI_ERROR_NAM][i.ATT_ERROR_INFO_NAM]={},O[i.PRI_ERROR_NAM][i.ATT_ERROR_INFO_NAM][i.CNF_OPTIONAL]=1,O[i.PRI_ERROR_NAM][i.ATT_ERROR_INFO_NAM][i.CNF_MULTI]=0,O[i.PRI_ERROR_NAM][i.ATT_EXTENSION_ATTRIBUTE_NAM]={},O[i.PRI_ERROR_NAM][i.ATT_EXTENSION_ATTRIBUTE_NAM][i.CNF_OPTIONAL]=1,O[i.PRI_ERROR_NAM][i.ATT_EXTENSION_ATTRIBUTE_NAM][i.CNF_MULTI]=1,t.prototype.getPriorityValues=function(){return a},t.prototype.getStatusValues=function(){return M},t.prototype.validatePacket=function(_){try{return this.isValidHeaderFormat(_),this.checkValidMessageFormat(_),_}catch(e){throw E("validatePacket(): invalid message format: "+JSON.stringify(_)),e}},t.prototype.createHeader=function(_,e){var t={};return t[i.HD_VER]=i.HD_VER_1,t[i.HD_PRIMITIVE]=_,t[i.HD_TRANSACTION_ID]=e,t[i.HD_CONFERENCE_ID]=this.conferenceId,t[i.HD_USER_ID]=this.userId,t[i.HD_ATTRIBUTES]={},t},t.prototype.isMine=function(_){return _[i.HD_USER_ID]===this.userId&&_[i.HD_CONFERENCE_ID]===this.conferenceId},t.prototype.isValidHeaderFormat=function(_){var e,t,T,A;for(A=Object.keys(_).length,T=0;A>T;T++)if(e=u[T],void 0===_[e])throw t="isValidHeaderFormat(): "+e+" was not founded in header: "+JSON.stringify(_),E(t),new N.InvalidHeaderFormat(t);return!0},t.prototype.checkValidMessageFormat=function(_){var e,t,A,r,o=[],s=_[i.HD_PRIMITIVE],n=JSON.stringify(_);if(I.indexOf(s)<0)throw r='checkValidMessageFormat(): message format error, primitive "'+s+"\" doesn't belong to primitives list: "+n,E(r),new N.InvalidMessageFormatPrimitive(r);var R=O[s];e=_[i.HD_ATTRIBUTES];for(var a in R)R[a][i.CNF_OPTIONAL]||e[a]||(r="checkValidMessageFormat(): message format error, no attribute "+a+": "+JSON.stringify(_),E(r),o.push(r));for(a in e)if(u.indexOf(a)<0)if(R[a])if(t=e[a],t instanceof Array)if(R[a][i.CNF_MULTI])for(var M=t.length,S=0;M>S;S++)A=t[S],o=T(a,A,o);else r="checkValidMessageFormat(): message format error, value of "+a+" doesn't fit with the format for "+s+"(value type shouldn't be an array): "+JSON.stringify(_),E(r),o.push(r);else R[a][i.CNF_MULTI]?(r="checkValidMessageFormat(): message format error, value of "+a+" doesn't fit with the format for "+s+"(value type should be an array): "+JSON.stringify(_),E(r),o.push(r)):o=T(a,t,o);else r="checkValidMessageFormat(): message format error, attribute "+a+" doesn't belong to "+s+" specification: "+JSON.stringify(_),E(r),o.push(r);r="checkValidMessageFormat(): these errors were founded in JSON message: "+n;for(var c=0;c<o.length;c++)r+="\n- "+o[c];if(c>0)throw E(r),new N.InvalidMessageFormat(r);return!0},t.prototype.createRequestFloor=function(_,e,t,T,A){var r=this.createHeader(i.PRI_FL_REQUEST_NAM,_);return r[i.HD_ATTRIBUTES][i.ATT_FL_ID_NAM]=e,t&&t!==this.userId&&(r[i.HD_ATTRIBUTES][i.ATT_BENEFICIARY_ID_NAM]=t),T&&(r[i.HD_ATTRIBUTES][i.ATT_PRIORITY_NAM]=T),A&&(r[i.HD_ATTRIBUTES][i.ATT_PARTICIPANT_PROVIDED_INFO_NAM]=A),this.validatePacket(r)},t.prototype.createReleaseFloor=function(_,e){var t=this.createHeader(i.PRI_FL_RELEASE_NAM,_);return t[i.HD_ATTRIBUTES][i.ATT_FL_REQUEST_ID_NAM]=e,this.validatePacket(t)},t.prototype.createChairAction=function(_,e){var t=this.createHeader(i.PRI_CH_ACTION_NAM,_);return t[i.HD_ATTRIBUTES][i.ATT_FLOOR_REQUEST_INFORMATION_NAM]=e,this.validatePacket(t)},t.prototype.createQueryFloor=function(_,e){var t=this.createHeader(i.PRI_FL_QUERY_NAM,_);return t[i.HD_ATTRIBUTES][i.ATT_FL_ID_NAM]=e,this.validatePacket(t)},t.prototype.createQueryFloorRequest=function(_,e){var t=this.createHeader(i.PRI_FL_REQUEST_QUERY_NAM,_);return t[i.HD_ATTRIBUTES][i.ATT_FL_REQUEST_ID_NAM]=e,this.validatePacket(t)},t.prototype.createQueryUser=function(_,e){var t=this.createHeader(i.PRI_FL_USER_QUERY_NAM,_);return e&&(t[i.HD_ATTRIBUTES][i.ATT_BENEFICIARY_ID_NAM]=e),this.validatePacket(t)},t.prototype.createHello=function(_){var e=this.createHeader(i.PRI_HELLO_NAM,_);return this.validatePacket(e)}},{"./Exceptions":1,debug:10}],7:[function(_,e){function t(_,e,t,T){r.call(this);var A=this;this.userId=e,this.conferenceId=_,this.floorList=T,this.transactionMap={},this.floorRequestMap={},this.floorQuery=null,this.messageFactory=new o(this.userId,this.conferenceId),this.transport=new s(this.messageFactory,t),this.closed=!1,this.transport.on("connected",function(){A.emit("connected"),A.queryFloor(T)}),this.transport.on("disconnected",function(_){A.emit("disconnected",_)}),this.transport.on("response",function(_){A.manageResponse(_)}),this.transport.on("notification",function(_){A.manageNotification(_)})}e.exports=t;var T=_("debug")("JsFCP:Participant"),A=_("debug")("JsFCP:ERROR:Participant");A.log=console.warn.bind(console);var r=_("events").EventEmitter,o=_("./MessageFactory"),s=_("./Transport"),n=_("./FloorRequest"),R=_("./FloorRelease"),E=_("./FloorQuery");t.prototype=new r,t.prototype.isWebSocketReady=function(){return this.transport.isWebSocketReady()},t.prototype.manageResponse=function(_){var e=_[o.C.HD_TRANSACTION_ID];if(this.transactionMap.hasOwnProperty(e)){var t=this.transactionMap[e];delete this.transactionMap[e];var A=_[o.C.HD_PRIMITIVE];A===o.C.PRI_ERROR_NAM?t.onErrorReceived(_):t instanceof n?t.onMessageReceived(_)===!0&&(this.floorRequestMap[t.floorRequestId]=t):t instanceof R?this.floorRequestMap.hasOwnProperty(t.floorRequestId)&&this.manageNotification(_):t instanceof E?t.onMessageReceived(_):T("manageResponse(): FloorRequest/FloorRelease was expected")}else T("manageResponse(): not a response, ignored")},t.prototype.manageNotification=function(_){var e=_[o.C.HD_PRIMITIVE];if(e===o.C.PRI_FL_REQUEST_STATUS_NAM){var t=_[o.C.HD_ATTRIBUTES][o.C.ATT_FLOOR_REQUEST_INFORMATION_NAM][o.C.ATT_FL_REQUEST_ID_NAM];if(this.floorRequestMap.hasOwnProperty(t)){var T=this.floorRequestMap[t];T.onMessageReceived(_)===!1&&delete this.floorRequestMap[t]}}else e===o.C.PRI_FL_STATUS_NAM&&this.floorQuery&&this.floorQuery.onMessageReceived(_)},t.prototype.requestFloor=function(_,e,t,A,r){if(T("requestFloor() | floorIds: %o",e),!Array.isArray(e)||0===e.length)throw new TypeError("pArrayFloorIds must be an array with at least one element");var o=Math.floor(1e4*Math.random());t||(t=this.userId);var s=new n(_,t);this.transactionMap[o]=s;var R=this.messageFactory.createRequestFloor(o,e,t,A,r);return this.transport.send(R),s},t.prototype.release=function(_,e){T("release() | floorRequest: %o",e);var t=null;if(t=e instanceof n?e.floorRequestId:parseInt(e),null!==t&&t!==Number.NaN){var A=Math.floor(1e4*Math.random()),r=new R(_,t,this.userId);this.transactionMap[A]=r;var o=this.messageFactory.createReleaseFloor(A,t);this.transport.send(o)}},t.prototype.queryFloor=function(_){T("queryFloor() | floorIds: %o",_);var e=this;if(_.length>0){var t=Math.floor(1e4*Math.random()),A=new E(_);this.transactionMap[t]=A,this.floorQuery=A,A.on("floorGranted",function(_){e.emit("floorGranted",_)}),A.on("floorReleased",function(_){e.emit("floorReleased",_)});var r=this.messageFactory.createQueryFloor(t,_);this.transport.send(r)}},t.prototype.close=function(){T("close()"),this.closed||this.transport.close()}},{"./FloorQuery":2,"./FloorRelease":3,"./FloorRequest":4,"./MessageFactory":6,"./Transport":8,debug:10,events:9}],8:[function(_,e){function t(_,e){A.call(this);var t=this;this.closed=!1;try{this.webSocket=new s(e),this.webSocket.onopen=function(){t.emit("connected")},this.webSocket.onmessage=function(_){t.onReceive(_)},this.webSocket.onclose=function(){t.emit("disconnected",{local:t.closed})},this.webSocket.onerror=function(){T("websocket error")},this.messageFactory=_}catch(r){throw T(r),new o.NoWebSocketException}}e.exports=t;var T=_("debug")("JsFCP:Transport"),A=_("events").EventEmitter,r=_("./MessageFactory"),o=_("./Exceptions"),s=_("websocket").w3cwebsocket;t.prototype=new A,t.prototype.isWebSocketReady=function(){return this.webSocket&&this.webSocket.readyState===this.webSocket.OPEN},t.prototype.send=function(_){var e=JSON.stringify(_);if(!this.isWebSocketReady())throw new o.NoWebSocketException;this.webSocket.send(e)},t.prototype.onReceive=function(_){T("onReceive() | msg: %o",_);var e;try{e=JSON.parse(_.data)}catch(t){return void T("onReceive() | received msg is not valid JSON")}try{if(this.messageFactory.isValidHeaderFormat(e),!this.messageFactory.isMine(e))return;if(this.messageFactory.checkValidMessageFormat(e)){var A=e[r.C.HD_TRANSACTION_ID];0===A?this.emit("notification",e):this.emit("response",e)}}catch(t){throw t}},t.prototype.close=function(){this.closed=!0,this.webSocket.close()}},{"./Exceptions":1,"./MessageFactory":6,debug:10,events:9,websocket:13}],9:[function(_,e){function t(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function T(_){return"function"==typeof _}function A(_){return"number"==typeof _}function r(_){return"object"==typeof _&&null!==_}function o(_){return void 0===_}e.exports=t,t.EventEmitter=t,t.prototype._events=void 0,t.prototype._maxListeners=void 0,t.defaultMaxListeners=10,t.prototype.setMaxListeners=function(_){if(!A(_)||0>_||isNaN(_))throw TypeError("n must be a positive number");return this._maxListeners=_,this},t.prototype.emit=function(_){var e,t,A,s,n,R;if(this._events||(this._events={}),"error"===_&&(!this._events.error||r(this._events.error)&&!this._events.error.length)){if(e=arguments[1],e instanceof Error)throw e;throw TypeError('Uncaught, unspecified "error" event.')}if(t=this._events[_],o(t))return!1;if(T(t))switch(arguments.length){case 1:t.call(this);break;case 2:t.call(this,arguments[1]);break;case 3:t.call(this,arguments[1],arguments[2]);break;default:for(A=arguments.length,s=new Array(A-1),n=1;A>n;n++)s[n-1]=arguments[n];t.apply(this,s)}else if(r(t)){for(A=arguments.length,s=new Array(A-1),n=1;A>n;n++)s[n-1]=arguments[n];for(R=t.slice(),A=R.length,n=0;A>n;n++)R[n].apply(this,s)}return!0},t.prototype.addListener=function(_,e){var A;if(!T(e))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",_,T(e.listener)?e.listener:e),this._events[_]?r(this._events[_])?this._events[_].push(e):this._events[_]=[this._events[_],e]:this._events[_]=e,r(this._events[_])&&!this._events[_].warned){var A;A=o(this._maxListeners)?t.defaultMaxListeners:this._maxListeners,A&&A>0&&this._events[_].length>A&&(this._events[_].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[_].length),"function"==typeof console.trace&&console.trace())
}return this},t.prototype.on=t.prototype.addListener,t.prototype.once=function(_,e){function t(){this.removeListener(_,t),A||(A=!0,e.apply(this,arguments))}if(!T(e))throw TypeError("listener must be a function");var A=!1;return t.listener=e,this.on(_,t),this},t.prototype.removeListener=function(_,e){var t,A,o,s;if(!T(e))throw TypeError("listener must be a function");if(!this._events||!this._events[_])return this;if(t=this._events[_],o=t.length,A=-1,t===e||T(t.listener)&&t.listener===e)delete this._events[_],this._events.removeListener&&this.emit("removeListener",_,e);else if(r(t)){for(s=o;s-->0;)if(t[s]===e||t[s].listener&&t[s].listener===e){A=s;break}if(0>A)return this;1===t.length?(t.length=0,delete this._events[_]):t.splice(A,1),this._events.removeListener&&this.emit("removeListener",_,e)}return this},t.prototype.removeAllListeners=function(_){var e,t;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[_]&&delete this._events[_],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(t=this._events[_],T(t))this.removeListener(_,t);else for(;t.length;)this.removeListener(_,t[t.length-1]);return delete this._events[_],this},t.prototype.listeners=function(_){var e;return e=this._events&&this._events[_]?T(this._events[_])?[this._events[_]]:this._events[_].slice():[]},t.listenerCount=function(_,e){var t;return t=_._events&&_._events[e]?T(_._events[e])?1:_._events[e].length:0}},{}],10:[function(_,e,t){function T(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function A(){var _=arguments,e=this.useColors;if(_[0]=(e?"%c":"")+this.namespace+(e?" %c":" ")+_[0]+(e?"%c ":" ")+"+"+t.humanize(this.diff),!e)return _;var T="color: "+this.color;_=[_[0],T,"color: inherit"].concat(Array.prototype.slice.call(_,1));var A=0,r=0;return _[0].replace(/%[a-z%]/g,function(_){"%%"!==_&&(A++,"%c"===_&&(r=A))}),_.splice(r,0,T),_}function r(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function o(_){try{null==_?n.removeItem("debug"):n.debug=_}catch(e){}}function s(){var _;try{_=n.debug}catch(e){}return _}t=e.exports=_("./debug"),t.log=r,t.formatArgs=A,t.save=o,t.load=s,t.useColors=T;var n;n="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:window.localStorage,t.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],t.formatters.j=function(_){return JSON.stringify(_)},t.enable(s())},{"./debug":11}],11:[function(_,e,t){function T(){return t.colors[E++%t.colors.length]}function A(_){function e(){}function A(){var _=A,e=+new Date,r=e-(R||e);_.diff=r,_.prev=R,_.curr=e,R=e,null==_.useColors&&(_.useColors=t.useColors()),null==_.color&&_.useColors&&(_.color=T());var o=Array.prototype.slice.call(arguments);o[0]=t.coerce(o[0]),"string"!=typeof o[0]&&(o=["%o"].concat(o));var s=0;o[0]=o[0].replace(/%([a-z%])/g,function(e,T){if("%%"===e)return e;s++;var A=t.formatters[T];if("function"==typeof A){var r=o[s];e=A.call(_,r),o.splice(s,1),s--}return e}),"function"==typeof t.formatArgs&&(o=t.formatArgs.apply(_,o));var n=A.log||t.log||console.log.bind(console);n.apply(_,o)}e.enabled=!1,A.enabled=!0;var r=t.enabled(_)?A:e;return r.namespace=_,r}function r(_){t.save(_);for(var e=(_||"").split(/[\s,]+/),T=e.length,A=0;T>A;A++)e[A]&&(_=e[A].replace(/\*/g,".*?"),"-"===_[0]?t.skips.push(new RegExp("^"+_.substr(1)+"$")):t.names.push(new RegExp("^"+_+"$")))}function o(){t.enable("")}function s(_){var e,T;for(e=0,T=t.skips.length;T>e;e++)if(t.skips[e].test(_))return!1;for(e=0,T=t.names.length;T>e;e++)if(t.names[e].test(_))return!0;return!1}function n(_){return _ instanceof Error?_.stack||_.message:_}t=e.exports=A,t.coerce=n,t.disable=o,t.enable=r,t.enabled=s,t.humanize=_("ms"),t.names=[],t.skips=[],t.formatters={};var R,E=0},{ms:12}],12:[function(_,e){function t(_){var e=/^((?:\d+)?\.?\d+) *(ms|seconds?|s|minutes?|m|hours?|h|days?|d|years?|y)?$/i.exec(_);if(e){var t=parseFloat(e[1]),T=(e[2]||"ms").toLowerCase();switch(T){case"years":case"year":case"y":return t*E;case"days":case"day":case"d":return t*R;case"hours":case"hour":case"h":return t*n;case"minutes":case"minute":case"m":return t*s;case"seconds":case"second":case"s":return t*o;case"ms":return t}}}function T(_){return _>=R?Math.round(_/R)+"d":_>=n?Math.round(_/n)+"h":_>=s?Math.round(_/s)+"m":_>=o?Math.round(_/o)+"s":_+"ms"}function A(_){return r(_,R,"day")||r(_,n,"hour")||r(_,s,"minute")||r(_,o,"second")||_+" ms"}function r(_,e,t){return e>_?void 0:1.5*e>_?Math.floor(_/e)+" "+t:Math.ceil(_/e)+" "+t+"s"}var o=1e3,s=60*o,n=60*s,R=24*n,E=365.25*R;e.exports=function(_,e){return e=e||{},"string"==typeof _?t(_):e.long?A(_):T(_)}},{}],13:[function(_,e){function t(_,e){var t;return t=e?new A(_,e):new A(_)}var T=function(){return this}(),A=T.WebSocket||T.MozWebSocket;e.exports={w3cwebsocket:A?t:null,version:_("./version")}},{"./version":14}],14:[function(_,e){e.exports=_("../package.json").version},{"../package.json":15}],15:[function(_,e){e.exports={name:"websocket",description:"Websocket Client & Server Library implementing the WebSocket protocol as specified in RFC 6455.",keywords:["websocket","websockets","socket","networking","comet","push","RFC-6455","realtime","server","client"],author:{name:"Brian McKelvey",email:"brian@worlize.com",url:"https://www.worlize.com/"},version:"1.0.17",repository:{type:"git",url:"https://github.com/theturtle32/WebSocket-Node.git"},homepage:"https://github.com/theturtle32/WebSocket-Node",engines:{node:">=0.8.0"},dependencies:{debug:"~2.1.0",nan:"~1.0.0","typedarray-to-buffer":"~3.0.0"},devDependencies:{"buffer-equal":"0.0.1",faucet:"0.0.1",gulp:"git+https://github.com/gulpjs/gulp.git#4.0","gulp-jshint":"^1.9.0","jshint-stylish":"^1.0.0",tape:"^3.0.0"},config:{verbose:!1},scripts:{install:"(node-gyp rebuild 2> builderror.log) || (exit 0)",test:"faucet test/unit",gulp:"gulp"},main:"index",directories:{lib:"./lib"},browser:"lib/browser.js",gitHead:"cda940b883aa884906ac13158fe514229a67f426",bugs:{url:"https://github.com/theturtle32/WebSocket-Node/issues"},_id:"websocket@1.0.17",_shasum:"8a572afc6ec120eb41473ca517d07d932f7b6a1c",_from:"websocket@>=1.0.17 <2.0.0",_npmVersion:"1.4.28",_npmUser:{name:"theturtle32",email:"brian@worlize.com"},maintainers:[{name:"theturtle32",email:"brian@worlize.com"}],dist:{shasum:"8a572afc6ec120eb41473ca517d07d932f7b6a1c",tarball:"http://registry.npmjs.org/websocket/-/websocket-1.0.17.tgz"},_resolved:"https://registry.npmjs.org/websocket/-/websocket-1.0.17.tgz",readme:"ERROR: No README data found!"}},{}]},{},[5])(5)});