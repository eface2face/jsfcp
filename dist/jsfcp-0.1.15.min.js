/*
 * JsFCP v0.1.15
 * JavaScript BFCP client implementation using WebSocket as transport and JSON as message format
 * Copyright 2013-2015 eFace2Face, inc. All Rights Reserved
 */
!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.JsFCP=e()}}(function(){return function e(t,_,r){function n(s,T){if(!_[s]){if(!t[s]){var i="function"==typeof require&&require;if(!T&&i)return i(s,!0);if(o)return o(s,!0);var A=new Error("Cannot find module '"+s+"'");throw A.code="MODULE_NOT_FOUND",A}var R=_[s]={exports:{}};t[s][0].call(R.exports,function(e){var _=t[s][1][e];return n(_?_:e)},R,R.exports,e,t,_,r)}return _[s].exports}for(var o="function"==typeof require&&require,s=0;s<r.length;s++)n(r[s]);return n}({1:[function(e,t){t.exports={InvalidMessageFormatPrimitive:function(){var e=function(e){this.code=101,this.name="INVALID_MESSAGE_FORMAT_PRIMITIVE",this.message=" Message format error. Primitive doesn't exist. "+e};return e.prototype=new Error,e}(),InvalidMessageFormat:function(){var e=function(e){this.code=102,this.name="INVALID_MESSAGE_FORMAT",this.message=e};return e.prototype=new Error,e}(),InvalidHeaderFormat:function(){var e=function(e){this.code=103,this.name="INVALID_HEADER_FORMAT",this.message=e};return e.prototype=new Error,e}(),NoWebSocketException:function(){var e=function(){this.code=200,this.name="NO_WEBSOCKET_EXCEPTION",this.message="There is no WebSocket available"};return e.prototype=new Error,e}()}},{}],2:[function(e,t){function _(e){o.call(this),this.arrayFloorIds=e}t.exports=_;var r=e("debug")("JsFCP:FloorQuery"),n=e("util"),o=e("events").EventEmitter,s=e("./MessageFactory");n.inherits(_,o),_.prototype.onMessageReceived=function(e){if(e[s.C.HD_PRIMITIVE]===s.C.PRI_FL_STATUS_NAM){var t=e[s.C.HD_ATTRIBUTES],_=t[s.C.ATT_FL_ID_NAM];if(t[s.C.ATT_FLOOR_REQUEST_INFORMATION_NAM]){var n,o,T;for(n=t[s.C.ATT_FLOOR_REQUEST_INFORMATION_NAM].length,o=0;n>o;o++)if(T=t[s.C.ATT_FLOOR_REQUEST_INFORMATION_NAM][o],T[s.C.ATT_OVERALL_REQUEST_STATUS_NAM]){var i=T[s.C.ATT_FL_REQUEST_ID_NAM],A=T[s.C.ATT_OVERALL_REQUEST_STATUS_NAM][s.C.ATT_REQUEST_STATUS_NAM];if(A&&A[s.C.ATT_REQUEST_STATUS_VALUE_NAM]){var R=A[s.C.ATT_REQUEST_STATUS_VALUE_NAM];if(T[s.C.ATT_BENEFICIARY_INFORMATION_NAM]){var E=T[s.C.ATT_BENEFICIARY_INFORMATION_NAM][s.C.ATT_BENEFICIARY_ID_NAM];R===s.C.RS_GRANTED_NAM?this.emit("floorGranted",{floorId:_,beneficiaryId:E,floorRequestId:i}):(R===s.C.RS_RELEASED_NAM||R===s.C.RS_REVOKED_NAM)&&this.emit("floorReleased",{floorId:_,beneficiaryId:E,floorRequestId:i})}}}}}else r("onMessageReceived(): FloorStatus was expected");return null},_.prototype.onErrorReceived=function(e){r("onErrorReceived(): "+e)}},{"./MessageFactory":6,debug:14,events:9,util:13}],3:[function(e,t){function _(e,t,_){this.beneficiaryId=_,this.floorRequestId=t,this.onError=e.error}t.exports=_;var r=e("debug")("JsFCP:FloorRelease"),n=e("./MessageFactory");_.prototype.onMessageReceived=function(e){r("onMessageReceived(): this function shouldn't be called, but was called with: "+e)},_.prototype.onErrorReceived=function(e){r("onErrorReceived(): ",e);var t=e[n.C.HD_ATTRIBUTES][n.C.ATT_ERROR_CODE_NAM],_=e[n.C.HD_ATTRIBUTES][n.C.ATT_ERROR_INFO_NAM];void 0!==this.onError&&this.onError({errorCode:t,errorInfo:_})}},{"./MessageFactory":6,debug:14}],4:[function(e,t){function _(e,t){this.beneficiaryId=t,this.queuePosition=null,this.status=null,this.floorRequestId=null,this.statusInfo=null,this.onPending=e.pending,this.onAccepted=e.accepted,this.onGranted=e.granted,this.onDenied=e.denied,this.onCancelled=e.cancelled,this.onReleased=e.released,this.onRevoked=e.revoked,this.onError=e.error}function r(e,t){return null===e?!1:null===t?!0:t===e?!1:e===o.C.RS_GRANTED_NAM||e===o.C.RS_DENIED_NAM||e===o.C.RS_CANCELLED_NAM||e===o.C.RS_RELEASED_NAM||e===o.C.RS_REVOKED_NAM?!0:t===o.C.RS_GRANTED_NAM?!1:t===o.C.RS_PENDING_NAM&&e===o.C.RS_ACCEPTED_NAM?!0:t===o.C.RS_ACCEPTED_NAM?!1:void 0}t.exports=_;var n=e("debug")("JsFCP:FloorRequest"),o=e("./MessageFactory");_.prototype.onMessageReceived=function(e){if(e[o.C.HD_PRIMITIVE]===o.C.PRI_FL_REQUEST_STATUS_NAM){var t=e[o.C.HD_ATTRIBUTES][o.C.ATT_FLOOR_REQUEST_INFORMATION_NAM],_=e[o.C.HD_ATTRIBUTES][o.C.ATT_STATUS_INFO_NAM];if(t[o.C.ATT_OVERALL_REQUEST_STATUS_NAM]){var s=t[o.C.ATT_OVERALL_REQUEST_STATUS_NAM][o.C.ATT_REQUEST_STATUS_NAM];if(s){var T=s[o.C.ATT_REQUEST_STATUS_VALUE_NAM];if(T&&r(T,this.status)){if(_&&(this.statusInfo=_),this.status=s[o.C.ATT_REQUEST_STATUS_VALUE_NAM],s[o.C.ATT_QUEUE_POSITION_NAM]&&(this.queuePosition=s[o.C.ATT_QUEUE_POSITION_NAM]),this.floorRequestId=t[o.C.ATT_FL_REQUEST_ID_NAM],this.status===o.C.RS_PENDING_NAM)return n("onMessageReceived(): onPending ",this.floorRequestId),this.onPending(this),!0;if(this.status===o.C.RS_ACCEPTED_NAM)return n("onMessageReceived(): onAccepted ",this.floorRequestId),this.onAccepted(this),!0;if(this.status===o.C.RS_GRANTED_NAM)return n("onMessageReceived(): onGranted ",this.floorRequestId),this.onGranted(this),!0;if(this.status===o.C.RS_DENIED_NAM)return n("onMessageReceived(): onDenied ",this.floorRequestId),this.onDenied(),!1;if(this.status===o.C.RS_CANCELLED_NAM)return n("onMessageReceived(): onCancelled ",this.floorRequestId),this.onCancelled(),!1;if(this.status===o.C.RS_RELEASED_NAM)return n("onMessageReceived(): onReleased ",this.floorRequestId),this.onReleased(),!1;if(this.status===o.C.RS_REVOKED_NAM)return n("onMessageReceived(): onRevoked ",this.floorRequestId),this.onRevoked(),!1}}}}else n("onMessageReceived(): FloorRequestStatus was expected");return null},_.prototype.onErrorReceived=function(e){n("onErrorReceived(): "+e);var t=e[o.C.HD_ATTRIBUTES][o.C.ATT_ERROR_CODE_NAM],_=e[o.C.HD_ATTRIBUTES][o.C.ATT_ERROR_INFO_NAM];void 0!==this.onError&&this.onError({errorCode:t,errorInfo:_})}},{"./MessageFactory":6,debug:14}],5:[function(e,t){var _={Participant:e("./Participant"),Exceptions:e("./Exceptions"),debug:e("debug")};t.exports=_},{"./Exceptions":1,"./Participant":7,debug:14}],6:[function(e,t){function _(e,t){this.conferenceId=t,this.userId=e}function r(e,t,_){var E,N,c,I=[],u=_;if(s(e)&&(I=o(t),c=u.length,u=n(I,M[e],u),u.length!==c))return u;switch(e){case a.ATT_PRIORITY_NAM:T(t)||(N="checkJsfcpAttributeFormat(): attribute "+a.ATT_PRIORITY_NAM+', "'+t+'" is not a valid value',R(N),u.push(N));break;case a.ATT_REQUEST_STATUS_NAM:var l=t[a.ATT_REQUEST_STATUS_VALUE_NAM];l&&"undefined"!==l||(N="checkJsfcpAttributeFormat(): attribute "+a.ATT_REQUEST_STATUS_NAM+", "+a.ATT_REQUEST_STATUS_VALUE_NAM+" was found",R(N),u.push(N)),i(l)||(N="checkJsfcpAttributeFormat(): attribute "+a.ATT_REQUEST_STATUS_NAM+', "'+l+'" is not a valid value',R(N),u.push(N));break;case a.ATT_ERROR_CODE_NAM:A(t)||(N="checkJsfcpAttributeFormat(): attribute "+a.ATT_ERROR_CODE_NAM+', "'+t+'" is not a valid value for attribute '+a.ATT_ERROR_CODE_NAM,R(N),u.push(N));break;case a.ATT_FLOOR_REQUEST_INFORMATION_NAM:E=I.indexOf(a.ATT_FL_REQUEST_ID_NAM),0>E&&(N="checkJsfcpAttributeFormat(): Attribute "+a.ATT_FLOOR_REQUEST_INFORMATION_NAM+", no "+a.ATT_FL_REQUEST_ID_NAM+" was found",R(N),u.push(N)),I.indexOf(a.ATT_FL_REQUEST_STATUS_NAM)<0?(N="checkJsfcpAttributeFormat(): attribute "+a.ATT_FLOOR_REQUEST_INFORMATION_NAM+", no "+a.ATT_FL_REQUEST_STATUS_NAM+" was found",R(N),u.push(N)):t[a.ATT_FL_REQUEST_STATUS_NAM]instanceof Array||(N="checkJsfcpAttributeFormat(): attribute "+a.ATT_FLOOR_REQUEST_INFORMATION_NAM+", "+a.ATT_FL_REQUEST_STATUS_NAM+" should be an array",R(N),u.push(N));break;case a.ATT_OVERALL_REQUEST_STATUS_NAM:E=I.indexOf(a.ATT_FL_REQUEST_ID_NAM),0>E&&(N="checkJsfcpAttributeFormat(): attribute "+a.ATT_OVERALL_REQUEST_STATUS_NAM+", no "+a.ATT_FL_REQUEST_ID_NAM+" was found",R(N),u.push(N));break;case a.ATT_FL_REQUEST_STATUS_NAM:E=I.indexOf(a.ATT_FL_ID_NAM),0>E&&(N="checkJsfcpAttributeFormat(): attribute "+a.ATT_FL_REQUEST_STATUS_NAM+", no "+a.ATT_FL_ID_NAM+" was found",R(N),u.push(N));break;case a.ATT_BENEFICIARY_INFORMATION_NAM:E=I.indexOf(a.ATT_BENEFICIARY_ID_NAM),0>E&&(N="checkJsfcpAttributeFormat(): attribute "+a.ATT_BENEFICIARY_INFORMATION_NAM+", no "+a.ATT_BENEFICIARY_ID_NAM+" was found",R(N),u.push(N));break;case a.ATT_REQUESTED_BY_INFORMATION_NAM:E=I.indexOf(a.ATT_REQUESTED_BY_ID_NAM),0>E&&(N="checkJsfcpAttributeFormat(): attribute "+a.ATT_REQUESTED_BY_INFORMATION_NAM+", no "+a.ATT_REQUESTED_BY_ID_NAM+" was found",R(N),u.push(N))}return c=u.length,I.forEach(function(e){if(s(e)||e===a.ATT_PRIORITY_NAM)if(t[e]instanceof Array)for(var _=t[e].length,n=0;_>n;n++)u=r(e,t[e][n],u);else if(u=r(e,t[e],u),u.length!==c)return u}),u}function n(e,t,_){for(var r,n=e.length,o=_,s=0;n>s;s++){var T=t.indexOf(e[s]);0>T&&(r="checkValidAttributes(): attribute list ["+e+"], invalid attribute list because of ["+e[s]+"]",R(r),o.push(r))}return o}function o(e){var t=[];for(var _ in e)t.push(_);return t}function s(e){return M[e]?!0:!1}function T(e){return c.indexOf(e)>=0?!0:!1}function i(e){return I.indexOf(e)>=0?!0:!1}function A(e){return u.indexOf(e)>=0?!0:!1}t.exports=_;var R=e("debug")("JsFCP:MessageFactory"),E=e("./Exceptions"),a={CNF_OPTIONAL:"optional",CNF_MULTI:"multiple",HD_VER:"ver",HD_VER_1:1,HD_PRIMITIVE:"primitive",HD_CONFERENCE_ID:"conferenceId",HD_TRANSACTION_ID:"transactionId",HD_USER_ID:"userId",HD_HEADER:"header",HD_ATTRIBUTES:"attributes",PRI_FL_REQUEST_NAM:"FloorRequest",PRI_FL_REQUEST_VAL:1,PRI_FL_RELEASE_NAM:"FloorRelease",PRI_FL_RELEASE_VAL:2,PRI_FL_REQUEST_QUERY_NAM:"FloorRequestQuery",PRI_FL_REQUEST_QUERY_VAL:3,PRI_FL_REQUEST_STATUS_NAM:"FloorRequestStatus",PRI_FL_REQUEST_STATUS_VAL:4,PRI_FL_USER_QUERY_NAM:"UserQuery",PRI_FL_USER_QUERY_VAL:5,PRI_FL_USER_STATUS_NAM:"UserStatus",PRI_FL_USER_STATUS_VAL:6,PRI_FL_QUERY_NAM:"FloorQuery",PRI_FL_QUERY_VAL:7,PRI_FL_STATUS_NAM:"FloorStatus",PRI_FL_STATUS_VAL:8,PRI_CH_ACTION_NAM:"ChairAction",PRI_CH_ACTION_VAL:9,PRI_CH_ACTION_ACK_NAM:"ChairActionAck",PRI_CH_ACTION_ACK_VAL:10,PRI_HELLO_NAM:"Hello",PRI_HELLO_VAL:11,PRI_HELLO_ACK_NAM:"HelloAck",PRI_HELLO_ACK_VAL:12,PRI_ERROR_NAM:"Error",PRI_ERROR_VAL:13,ATT_BENEFICIARY_ID_NAM:"beneficiaryId",ATT_BENEFICIARY_ID_VAL:1,ATT_FL_ID_NAM:"floorId",ATT_FL_ID_VAL:2,ATT_FL_REQUEST_ID_NAM:"floorRequestId",ATT_FL_REQUEST_ID_VAL:3,ATT_PRIORITY_NAM:"priority",ATT_PRIORITY_VAL:4,ATT_REQUEST_STATUS_NAM:"requestStatus",ATT_REQUEST_STATUS_VAL:5,ATT_ERROR_CODE_NAM:"errorCode",ATT_ERROR_CODE_VAL:6,ATT_ERROR_INFO_NAM:"errorInfo",ATT_ERROR_INFO_VAL:7,ATT_PARTICIPANT_PROVIDED_INFO_NAM:"participantProvidedInfo",ATT_PARTICIPANT_PROVIDED_INFO_VAL:8,ATT_STATUS_INFO_NAM:"statusInfo",ATT_STATUS_INFO_VAL:9,ATT_SUPPORTED_ATTRIBUTES_NAM:"supportedAttributes",ATT_SUPPORTED_ATTRIBUTES_VAL:10,ATT_SUPPORTED_PRIMITIVES_NAM:"supportedPrimitives",ATT_SUPPORTED_PRIMITIVES_VAL:11,ATT_USER_DISPLAY_NAME_NAM:"userDisplayName",ATT_USER_DISPLAY_NAME_VAL:12,ATT_USER_URI_NAM:"userUri",ATT_USER_URI_VAL:13,ATT_BENEFICIARY_INFORMATION_NAM:"beneficiaryInformation",ATT_BENEFICIARY_INFORMATION_VAL:14,ATT_FLOOR_REQUEST_INFORMATION_NAM:"floorRequestInformation",ATT_FLOOR_REQUEST_INFORMATION_VAL:15,ATT_REQUESTED_BY_INFORMATION_NAM:"requestedByInformation",ATT_REQUESTED_BY_INFORMATION_VAL:16,ATT_FL_REQUEST_STATUS_NAM:"floorRequestStatus",ATT_FL_REQUEST_STATUS_VAL:17,ATT_OVERALL_REQUEST_STATUS_NAM:"overallRequestStatus",ATT_OVERALL_REQUEST_STATUS_VAL:18,ATT_REQUESTED_BY_ID_NAM:"requestedById",ATT_REQUESTED_BY_ID_VAL:19,ATT_EXTENSION_ATTRIBUTE_NAM:"extensionAttribute",ATT_EXTENSION_ATTRIBUTE_VAL:20,ATT_REQUEST_STATUS_VALUE_NAM:"status",ATT_REQUEST_STATUS_VALUE_VAL:21,ATT_QUEUE_POSITION_NAM:"queuePosition",ATT_QUEUE_POSITION_VAL:22,ATT_SUPPORTED_FLOORTYPES_NAM:"supportedFloorTypes",ATT_SUPPORTED_FLOORTYPES_VAL:23,PR_LOWEST_NAM:"Lowest",PR_LOWEST_VAL:0,PR_LOW_NAM:"Low",PR_LOW_VAL:1,PR_NORMAL_NAM:"Normal",PR_NORMAL_VAL:2,PR_HIGH_NAM:"High",PR_HIGH_VAL:3,PR_HIGHEST_NAM:"Highest",PR_HIGHEST_VAL:4,RS_PENDING_NAM:"Pending",RS_PENDING_VAL:1,RS_ACCEPTED_NAM:"Accepted",RS_ACCEPTED_VAL:2,RS_GRANTED_NAM:"Granted",RS_GRANTED_VAL:3,RS_DENIED_NAM:"Denied",RS_DENIED_VAL:4,RS_CANCELLED_NAM:"Cancelled",RS_CANCELLED_VAL:5,RS_RELEASED_NAM:"Released",RS_RELEASED_VAL:6,RS_REVOKED_NAM:"Revoked",RS_REVOKED_VAL:7,ERR_NO_CONF_NAM:"ErrorConferenceDoesNotExist",ERR_NO_CONF_VAL:1,ERR_NO_USER_NAM:"UserDoesNotExist",ERR_NO_USER_VAL:2,ERR_UNK_PR_NAM:"UnknownPrimitive",ERR_UNK_PR_VAL:3,ERR_UNK_ATT_NAM:"UnknownMandatoryAttribute",ERR_UNK_ATT_VAL:4,ERR_UNAUTH_OP_NAM:"UnauthorizedOperation",ERR_UNAUTH_OP_VAL:5,ERR_INV_FL_ID_NAM:"InvalidFloorId",ERR_INV_FL_ID_VAL:6,ERR_NO_FL_RQ_ID_NAM:"FloorRequestIdDoesNotExist",ERR_NO_FL_RQ_ID_VAL:7,ERR_MAX_FL_RQ_NAM:"FloorRequestMaxNumberReached",ERR_MAX_FL_RQ_VAL:8,ERR_TLS_NAM:"UseTls",ERR_TLS_VAL:9};_.C=a;var N=[a.PRI_FL_REQUEST_NAM,a.PRI_FL_RELEASE_NAM,a.PRI_FL_REQUEST_QUERY_NAM,a.PRI_FL_REQUEST_STATUS_NAM,a.PRI_FL_USER_QUERY_NAM,a.PRI_FL_USER_STATUS_NAM,a.PRI_FL_QUERY_NAM,a.PRI_FL_STATUS_NAM,a.PRI_CH_ACTION_NAM,a.PRI_CH_ACTION_ACK_NAM,a.PRI_HELLO_NAM,a.PRI_HELLO_ACK_NAM,a.PRI_ERROR_NAM],c=[a.PR_LOWEST_NAM,a.PR_LOW_NAM,a.PR_NORMAL_NAM,a.PR_HIGH_NAM,a.PR_HIGHEST_NAM],I=[a.RS_PENDING_NAM,a.RS_ACCEPTED_NAM,a.RS_GRANTED_NAM,a.RS_DENIED_NAM,a.RS_CANCELLED_NAM,a.RS_RELEASED_NAM,a.RS_REVOKED_NAM],u=[a.ERR_NO_CONF_NAM,a.ERR_NO_USER_NAM,a.ERR_UNK_PR_NAM,a.ERR_UNK_ATT_NAM,a.ERR_UNAUTH_OP_NAM,a.ERR_INV_FL_ID_NAM,a.ERR_NO_FL_RQ_ID_NAM,a.ERR_MAX_FL_RQ_NAM,a.ERR_TLS_NAM],M={};M[a.ATT_BENEFICIARY_INFORMATION_NAM]=[a.ATT_BENEFICIARY_ID_NAM,a.ATT_USER_DISPLAY_NAME_NAM,a.ATT_USER_URI_NAM,a.ATT_EXTENSION_ATTRIBUTE_NAM],M[a.ATT_FLOOR_REQUEST_INFORMATION_NAM]=[a.ATT_FL_REQUEST_ID_NAM,a.ATT_OVERALL_REQUEST_STATUS_NAM,a.ATT_FL_REQUEST_STATUS_NAM,a.ATT_BENEFICIARY_INFORMATION_NAM,a.ATT_REQUESTED_BY_INFORMATION_NAM,a.ATT_PRIORITY_NAM,a.ATT_PARTICIPANT_PROVIDED_INFO_NAM,a.ATT_EXTENSION_ATTRIBUTE_NAM],M[a.ATT_REQUESTED_BY_INFORMATION_NAM]=[a.ATT_REQUESTED_BY_ID_NAM,a.ATT_USER_DISPLAY_NAME_NAM,a.ATT_USER_URI_NAM,a.ATT_EXTENSION_ATTRIBUTE_NAM],M[a.ATT_FL_REQUEST_STATUS_NAM]=[a.ATT_FL_ID_NAM,a.ATT_REQUEST_STATUS_NAM,a.ATT_STATUS_INFO_NAM,a.ATT_EXTENSION_ATTRIBUTE_NAM],M[a.ATT_OVERALL_REQUEST_STATUS_NAM]=[a.ATT_FL_REQUEST_ID_NAM,a.ATT_REQUEST_STATUS_NAM,a.ATT_STATUS_INFO_NAM,a.ATT_EXTENSION_ATTRIBUTE_NAM],M[a.ATT_REQUEST_STATUS_NAM]=[a.ATT_REQUEST_STATUS_VALUE_NAM,a.ATT_QUEUE_POSITION_NAM];var l=[a.HD_VER,a.HD_PRIMITIVE,a.HD_CONFERENCE_ID,a.HD_TRANSACTION_ID,a.HD_USER_ID,a.HD_ATTRIBUTES],S={};S[a.PRI_FL_REQUEST_NAM]={},S[a.PRI_FL_REQUEST_NAM][a.ATT_FL_ID_NAM]={},S[a.PRI_FL_REQUEST_NAM][a.ATT_FL_ID_NAM][a.CNF_OPTIONAL]=0,S[a.PRI_FL_REQUEST_NAM][a.ATT_FL_ID_NAM][a.CNF_MULTI]=1,S[a.PRI_FL_REQUEST_NAM][a.ATT_BENEFICIARY_ID_NAM]={},S[a.PRI_FL_REQUEST_NAM][a.ATT_BENEFICIARY_ID_NAM][a.CNF_OPTIONAL]=1,S[a.PRI_FL_REQUEST_NAM][a.ATT_BENEFICIARY_ID_NAM][a.CNF_MULTI]=0,S[a.PRI_FL_REQUEST_NAM][a.ATT_PARTICIPANT_PROVIDED_INFO_NAM]={},S[a.PRI_FL_REQUEST_NAM][a.ATT_PARTICIPANT_PROVIDED_INFO_NAM][a.CNF_OPTIONAL]=1,S[a.PRI_FL_REQUEST_NAM][a.ATT_PARTICIPANT_PROVIDED_INFO_NAM][a.CNF_MULTI]=0,S[a.PRI_FL_REQUEST_NAM][a.ATT_PRIORITY_NAM]={},S[a.PRI_FL_REQUEST_NAM][a.ATT_PRIORITY_NAM][a.CNF_OPTIONAL]=1,S[a.PRI_FL_REQUEST_NAM][a.ATT_PRIORITY_NAM][a.CNF_MULTI]=0,S[a.PRI_FL_REQUEST_NAM][a.ATT_EXTENSION_ATTRIBUTE_NAM]={},S[a.PRI_FL_REQUEST_NAM][a.ATT_EXTENSION_ATTRIBUTE_NAM][a.CNF_OPTIONAL]=1,S[a.PRI_FL_REQUEST_NAM][a.ATT_EXTENSION_ATTRIBUTE_NAM][a.CNF_MULTI]=1,S[a.PRI_FL_REQUEST_NAM]={},S[a.PRI_FL_REQUEST_NAM][a.ATT_FL_ID_NAM]={},S[a.PRI_FL_REQUEST_NAM][a.ATT_FL_ID_NAM][a.CNF_OPTIONAL]=0,S[a.PRI_FL_REQUEST_NAM][a.ATT_FL_ID_NAM][a.CNF_MULTI]=1,S[a.PRI_FL_REQUEST_NAM][a.ATT_BENEFICIARY_ID_NAM]={},S[a.PRI_FL_REQUEST_NAM][a.ATT_BENEFICIARY_ID_NAM][a.CNF_OPTIONAL]=1,S[a.PRI_FL_REQUEST_NAM][a.ATT_BENEFICIARY_ID_NAM][a.CNF_MULTI]=0,S[a.PRI_FL_REQUEST_NAM][a.ATT_PARTICIPANT_PROVIDED_INFO_NAM]={},S[a.PRI_FL_REQUEST_NAM][a.ATT_PARTICIPANT_PROVIDED_INFO_NAM][a.CNF_OPTIONAL]=1,S[a.PRI_FL_REQUEST_NAM][a.ATT_PARTICIPANT_PROVIDED_INFO_NAM][a.CNF_MULTI]=0,S[a.PRI_FL_REQUEST_NAM][a.ATT_PRIORITY_NAM]={},S[a.PRI_FL_REQUEST_NAM][a.ATT_PRIORITY_NAM][a.CNF_OPTIONAL]=1,S[a.PRI_FL_REQUEST_NAM][a.ATT_PRIORITY_NAM][a.CNF_MULTI]=0,S[a.PRI_FL_REQUEST_NAM][a.ATT_EXTENSION_ATTRIBUTE_NAM]={},S[a.PRI_FL_REQUEST_NAM][a.ATT_EXTENSION_ATTRIBUTE_NAM][a.CNF_OPTIONAL]=1,S[a.PRI_FL_REQUEST_NAM][a.ATT_EXTENSION_ATTRIBUTE_NAM][a.CNF_MULTI]=1,S[a.PRI_FL_RELEASE_NAM]={},S[a.PRI_FL_RELEASE_NAM][a.ATT_FL_REQUEST_ID_NAM]={},S[a.PRI_FL_RELEASE_NAM][a.ATT_FL_REQUEST_ID_NAM][a.CNF_OPTIONAL]=0,S[a.PRI_FL_RELEASE_NAM][a.ATT_FL_REQUEST_ID_NAM][a.CNF_MULTI]=0,S[a.PRI_FL_RELEASE_NAM][a.ATT_EXTENSION_ATTRIBUTE_NAM]={},S[a.PRI_FL_RELEASE_NAM][a.ATT_EXTENSION_ATTRIBUTE_NAM][a.CNF_OPTIONAL]=1,S[a.PRI_FL_RELEASE_NAM][a.ATT_EXTENSION_ATTRIBUTE_NAM][a.CNF_MULTI]=1,S[a.PRI_FL_REQUEST_QUERY_NAM]={},S[a.PRI_FL_REQUEST_QUERY_NAM][a.ATT_FL_REQUEST_ID_NAM]={},S[a.PRI_FL_REQUEST_QUERY_NAM][a.ATT_FL_REQUEST_ID_NAM][a.CNF_OPTIONAL]=0,S[a.PRI_FL_REQUEST_QUERY_NAM][a.ATT_FL_REQUEST_ID_NAM][a.CNF_MULTI]=0,S[a.PRI_FL_REQUEST_QUERY_NAM][a.ATT_EXTENSION_ATTRIBUTE_NAM]={},S[a.PRI_FL_REQUEST_QUERY_NAM][a.ATT_EXTENSION_ATTRIBUTE_NAM][a.CNF_OPTIONAL]=1,S[a.PRI_FL_REQUEST_QUERY_NAM][a.ATT_EXTENSION_ATTRIBUTE_NAM][a.CNF_MULTI]=1,S[a.PRI_FL_REQUEST_STATUS_NAM]={},S[a.PRI_FL_REQUEST_STATUS_NAM][a.ATT_FLOOR_REQUEST_INFORMATION_NAM]={},S[a.PRI_FL_REQUEST_STATUS_NAM][a.ATT_FLOOR_REQUEST_INFORMATION_NAM][a.CNF_OPTIONAL]=0,S[a.PRI_FL_REQUEST_STATUS_NAM][a.ATT_FLOOR_REQUEST_INFORMATION_NAM][a.CNF_MULTI]=0,S[a.PRI_FL_REQUEST_STATUS_NAM][a.ATT_EXTENSION_ATTRIBUTE_NAM]={},S[a.PRI_FL_REQUEST_STATUS_NAM][a.ATT_EXTENSION_ATTRIBUTE_NAM][a.CNF_OPTIONAL]=1,S[a.PRI_FL_REQUEST_STATUS_NAM][a.ATT_EXTENSION_ATTRIBUTE_NAM][a.CNF_MULTI]=1,S[a.PRI_FL_USER_QUERY_NAM]={},S[a.PRI_FL_USER_QUERY_NAM][a.ATT_BENEFICIARY_ID_NAM]={},S[a.PRI_FL_USER_QUERY_NAM][a.ATT_BENEFICIARY_ID_NAM][a.CNF_OPTIONAL]=1,S[a.PRI_FL_USER_QUERY_NAM][a.ATT_BENEFICIARY_ID_NAM][a.CNF_MULTI]=0,S[a.PRI_FL_USER_QUERY_NAM][a.ATT_EXTENSION_ATTRIBUTE_NAM]={},S[a.PRI_FL_USER_QUERY_NAM][a.ATT_EXTENSION_ATTRIBUTE_NAM][a.CNF_OPTIONAL]=1,S[a.PRI_FL_USER_QUERY_NAM][a.ATT_EXTENSION_ATTRIBUTE_NAM][a.CNF_MULTI]=1,S[a.PRI_FL_USER_STATUS_NAM]={},S[a.PRI_FL_USER_STATUS_NAM][a.ATT_BENEFICIARY_INFORMATION_NAM]={},S[a.PRI_FL_USER_STATUS_NAM][a.ATT_BENEFICIARY_INFORMATION_NAM][a.CNF_OPTIONAL]=1,S[a.PRI_FL_USER_STATUS_NAM][a.ATT_BENEFICIARY_INFORMATION_NAM][a.CNF_MULTI]=0,S[a.PRI_FL_USER_STATUS_NAM][a.ATT_FLOOR_REQUEST_INFORMATION_NAM]={},S[a.PRI_FL_USER_STATUS_NAM][a.ATT_FLOOR_REQUEST_INFORMATION_NAM][a.CNF_OPTIONAL]=0,S[a.PRI_FL_USER_STATUS_NAM][a.ATT_FLOOR_REQUEST_INFORMATION_NAM][a.CNF_MULTI]=1,S[a.PRI_FL_USER_STATUS_NAM][a.ATT_EXTENSION_ATTRIBUTE_NAM]={},S[a.PRI_FL_USER_STATUS_NAM][a.ATT_EXTENSION_ATTRIBUTE_NAM][a.CNF_OPTIONAL]=1,S[a.PRI_FL_USER_STATUS_NAM][a.ATT_EXTENSION_ATTRIBUTE_NAM][a.CNF_MULTI]=1,S[a.PRI_FL_QUERY_NAM]={},S[a.PRI_FL_QUERY_NAM][a.ATT_FL_ID_NAM]={},S[a.PRI_FL_QUERY_NAM][a.ATT_FL_ID_NAM][a.CNF_OPTIONAL]=0,S[a.PRI_FL_QUERY_NAM][a.ATT_FL_ID_NAM][a.CNF_MULTI]=1,S[a.PRI_FL_QUERY_NAM][a.ATT_EXTENSION_ATTRIBUTE_NAM]={},S[a.PRI_FL_QUERY_NAM][a.ATT_EXTENSION_ATTRIBUTE_NAM][a.CNF_OPTIONAL]=1,S[a.PRI_FL_QUERY_NAM][a.ATT_EXTENSION_ATTRIBUTE_NAM][a.CNF_MULTI]=1,S[a.PRI_FL_STATUS_NAM]={},S[a.PRI_FL_STATUS_NAM][a.ATT_FL_ID_NAM]={},S[a.PRI_FL_STATUS_NAM][a.ATT_FL_ID_NAM][a.CNF_OPTIONAL]=0,S[a.PRI_FL_STATUS_NAM][a.ATT_FL_ID_NAM][a.CNF_MULTI]=0,S[a.PRI_FL_STATUS_NAM][a.ATT_FLOOR_REQUEST_INFORMATION_NAM]={},S[a.PRI_FL_STATUS_NAM][a.ATT_FLOOR_REQUEST_INFORMATION_NAM][a.CNF_OPTIONAL]=1,S[a.PRI_FL_STATUS_NAM][a.ATT_FLOOR_REQUEST_INFORMATION_NAM][a.CNF_MULTI]=1,S[a.PRI_FL_STATUS_NAM][a.ATT_EXTENSION_ATTRIBUTE_NAM]={},S[a.PRI_FL_STATUS_NAM][a.ATT_EXTENSION_ATTRIBUTE_NAM][a.CNF_OPTIONAL]=1,S[a.PRI_FL_STATUS_NAM][a.ATT_EXTENSION_ATTRIBUTE_NAM][a.CNF_MULTI]=1,S[a.PRI_CH_ACTION_NAM]={},S[a.PRI_CH_ACTION_NAM][a.ATT_FLOOR_REQUEST_INFORMATION_NAM]={},S[a.PRI_CH_ACTION_NAM][a.ATT_FLOOR_REQUEST_INFORMATION_NAM][a.CNF_OPTIONAL]=0,S[a.PRI_CH_ACTION_NAM][a.ATT_FLOOR_REQUEST_INFORMATION_NAM][a.CNF_MULTI]=0,S[a.PRI_HELLO_NAM]={},S[a.PRI_HELLO_NAM][a.ATT_EXTENSION_ATTRIBUTE_NAM]={},S[a.PRI_HELLO_NAM][a.ATT_EXTENSION_ATTRIBUTE_NAM][a.CNF_OPTIONAL]=1,S[a.PRI_HELLO_NAM][a.ATT_EXTENSION_ATTRIBUTE_NAM][a.CNF_MULTI]=1,S[a.PRI_CH_ACTION_ACK_NAM]={},S[a.PRI_CH_ACTION_ACK_NAM][a.ATT_EXTENSION_ATTRIBUTE_NAM]={},S[a.PRI_CH_ACTION_ACK_NAM][a.ATT_EXTENSION_ATTRIBUTE_NAM][a.CNF_OPTIONAL]=1,S[a.PRI_CH_ACTION_ACK_NAM][a.ATT_EXTENSION_ATTRIBUTE_NAM][a.CNF_MULTI]=1,S[a.PRI_HELLO_NAM]={},S[a.PRI_HELLO_NAM][a.ATT_EXTENSION_ATTRIBUTE_NAM]={},S[a.PRI_HELLO_NAM][a.ATT_EXTENSION_ATTRIBUTE_NAM][a.CNF_OPTIONAL]=1,S[a.PRI_HELLO_NAM][a.ATT_EXTENSION_ATTRIBUTE_NAM][a.CNF_MULTI]=1,S[a.PRI_HELLO_ACK_NAM]={},S[a.PRI_HELLO_ACK_NAM][a.ATT_SUPPORTED_PRIMITIVES_NAM]={},S[a.PRI_HELLO_ACK_NAM][a.ATT_SUPPORTED_PRIMITIVES_NAM][a.CNF_OPTIONAL]=0,S[a.PRI_HELLO_ACK_NAM][a.ATT_SUPPORTED_PRIMITIVES_NAM][a.CNF_MULTI]=1,S[a.PRI_HELLO_ACK_NAM][a.ATT_SUPPORTED_ATTRIBUTES_NAM]={},S[a.PRI_HELLO_ACK_NAM][a.ATT_SUPPORTED_ATTRIBUTES_NAM][a.CNF_OPTIONAL]=0,S[a.PRI_HELLO_ACK_NAM][a.ATT_SUPPORTED_ATTRIBUTES_NAM][a.CNF_MULTI]=1,S[a.PRI_HELLO_ACK_NAM][a.ATT_SUPPORTED_FLOORTYPES_NAM]={},S[a.PRI_HELLO_ACK_NAM][a.ATT_SUPPORTED_FLOORTYPES_NAM][a.CNF_OPTIONAL]=1,S[a.PRI_HELLO_ACK_NAM][a.ATT_SUPPORTED_FLOORTYPES_NAM][a.CNF_MULTI]=1,S[a.PRI_HELLO_ACK_NAM][a.ATT_EXTENSION_ATTRIBUTE_NAM]={},S[a.PRI_HELLO_ACK_NAM][a.ATT_EXTENSION_ATTRIBUTE_NAM][a.CNF_OPTIONAL]=1,S[a.PRI_HELLO_ACK_NAM][a.ATT_EXTENSION_ATTRIBUTE_NAM][a.CNF_MULTI]=1,S[a.PRI_ERROR_NAM]={},S[a.PRI_ERROR_NAM][a.ATT_ERROR_CODE_NAM]={},S[a.PRI_ERROR_NAM][a.ATT_ERROR_CODE_NAM][a.CNF_OPTIONAL]=0,S[a.PRI_ERROR_NAM][a.ATT_ERROR_CODE_NAM][a.CNF_MULTI]=0,S[a.PRI_ERROR_NAM][a.ATT_ERROR_INFO_NAM]={},S[a.PRI_ERROR_NAM][a.ATT_ERROR_INFO_NAM][a.CNF_OPTIONAL]=1,S[a.PRI_ERROR_NAM][a.ATT_ERROR_INFO_NAM][a.CNF_MULTI]=0,S[a.PRI_ERROR_NAM][a.ATT_EXTENSION_ATTRIBUTE_NAM]={},S[a.PRI_ERROR_NAM][a.ATT_EXTENSION_ATTRIBUTE_NAM][a.CNF_OPTIONAL]=1,S[a.PRI_ERROR_NAM][a.ATT_EXTENSION_ATTRIBUTE_NAM][a.CNF_MULTI]=1,_.prototype.getPriorityValues=function(){return c},_.prototype.getStatusValues=function(){return I},_.prototype.validatePacket=function(e){try{return this.isValidHeaderFormat(e),this.checkValidMessageFormat(e),e}catch(t){throw R("validatePacket(): invalid message format: "+JSON.stringify(e)),t}},_.prototype.createHeader=function(e,t){var _={};return _[a.HD_VER]=a.HD_VER_1,_[a.HD_PRIMITIVE]=e,_[a.HD_TRANSACTION_ID]=t,_[a.HD_CONFERENCE_ID]=this.conferenceId,_[a.HD_USER_ID]=this.userId,_[a.HD_ATTRIBUTES]={},_},_.prototype.isMine=function(e){return e[a.HD_USER_ID]===this.userId&&e[a.HD_CONFERENCE_ID]===this.conferenceId},_.prototype.isValidHeaderFormat=function(e){var t,_,r,n;for(n=Object.keys(e).length,r=0;n>r;r++)if(t=l[r],void 0===e[t])throw _="isValidHeaderFormat(): "+t+" was not founded in header: "+JSON.stringify(e),R(_),new E.InvalidHeaderFormat(_);return!0},_.prototype.checkValidMessageFormat=function(e){var t,_,n,o,s=[],T=e[a.HD_PRIMITIVE],i=JSON.stringify(e);if(N.indexOf(T)<0)throw o='checkValidMessageFormat(): message format error, primitive "'+T+"\" doesn't belong to primitives list: "+i,R(o),new E.InvalidMessageFormatPrimitive(o);var A=S[T];t=e[a.HD_ATTRIBUTES];for(var c in A)A[c][a.CNF_OPTIONAL]||t[c]||(o="checkValidMessageFormat(): message format error, no attribute "+c+": "+JSON.stringify(e),R(o),s.push(o));for(c in t)if(l.indexOf(c)<0)if(A[c])if(_=t[c],_ instanceof Array)if(A[c][a.CNF_MULTI])for(var I=_.length,u=0;I>u;u++)n=_[u],s=r(c,n,s);else o="checkValidMessageFormat(): message format error, value of "+c+" doesn't fit with the format for "+T+"(value type shouldn't be an array): "+JSON.stringify(e),R(o),s.push(o);else A[c][a.CNF_MULTI]?(o="checkValidMessageFormat(): message format error, value of "+c+" doesn't fit with the format for "+T+"(value type should be an array): "+JSON.stringify(e),R(o),s.push(o)):s=r(c,_,s);else o="checkValidMessageFormat(): message format error, attribute "+c+" doesn't belong to "+T+" specification: "+JSON.stringify(e),R(o),s.push(o);o="checkValidMessageFormat(): these errors were founded in JSON message: "+i;for(var M=0;M<s.length;M++)o+="\n- "+s[M];if(M>0)throw R(o),new E.InvalidMessageFormat(o);return!0},_.prototype.createRequestFloor=function(e,t,_,r,n){var o=this.createHeader(a.PRI_FL_REQUEST_NAM,e);return o[a.HD_ATTRIBUTES][a.ATT_FL_ID_NAM]=t,_&&_!==this.userId&&(o[a.HD_ATTRIBUTES][a.ATT_BENEFICIARY_ID_NAM]=_),r&&(o[a.HD_ATTRIBUTES][a.ATT_PRIORITY_NAM]=r),n&&(o[a.HD_ATTRIBUTES][a.ATT_PARTICIPANT_PROVIDED_INFO_NAM]=n),this.validatePacket(o)},_.prototype.createReleaseFloor=function(e,t){var _=this.createHeader(a.PRI_FL_RELEASE_NAM,e);return _[a.HD_ATTRIBUTES][a.ATT_FL_REQUEST_ID_NAM]=t,this.validatePacket(_)},_.prototype.createChairAction=function(e,t){var _=this.createHeader(a.PRI_CH_ACTION_NAM,e);return _[a.HD_ATTRIBUTES][a.ATT_FLOOR_REQUEST_INFORMATION_NAM]=t,this.validatePacket(_)},_.prototype.createQueryFloor=function(e,t){var _=this.createHeader(a.PRI_FL_QUERY_NAM,e);return _[a.HD_ATTRIBUTES][a.ATT_FL_ID_NAM]=t,this.validatePacket(_)},_.prototype.createQueryFloorRequest=function(e,t){var _=this.createHeader(a.PRI_FL_REQUEST_QUERY_NAM,e);return _[a.HD_ATTRIBUTES][a.ATT_FL_REQUEST_ID_NAM]=t,this.validatePacket(_)},_.prototype.createQueryUser=function(e,t){var _=this.createHeader(a.PRI_FL_USER_QUERY_NAM,e);return t&&(_[a.HD_ATTRIBUTES][a.ATT_BENEFICIARY_ID_NAM]=t),this.validatePacket(_)},_.prototype.createHello=function(e){var t=this.createHeader(a.PRI_HELLO_NAM,e);return this.validatePacket(t)}},{"./Exceptions":1,debug:14}],7:[function(e,t){function _(e,t,_,r){s.call(this);var n=this;this.userId=t,this.conferenceId=e,this.floorList=r,this.transactionMap={},this.floorRequestMap={},this.floorQuery=null,this.messageFactory=new T(this.userId,this.conferenceId),this.transport=new i(this.messageFactory,_),this.closed=!1,this.transport.on("connected",function(){n.queryFloor(r),n.emit("connected")}),this.transport.on("reconnect",function(){n.queryFloor(r),n.emit("connected")}),this.transport.on("disconnected",function(e){n.emit("disconnected",e)}),this.transport.on("response",function(e){n.manageResponse(e)}),this.transport.on("notification",function(e){n.manageNotification(e)})}t.exports=_;var r=e("debug")("JsFCP:Participant"),n=e("debug")("JsFCP:ERROR:Participant");n.log=console.warn.bind(console);var o=e("util"),s=e("events").EventEmitter,T=e("./MessageFactory"),i=e("./Transport"),A=e("./FloorRequest"),R=e("./FloorRelease"),E=e("./FloorQuery");o.inherits(_,s),_.prototype.isWebSocketReady=function(){return this.transport.isWebSocketReady()},_.prototype.manageResponse=function(e){var t=e[T.C.HD_TRANSACTION_ID];if(this.transactionMap.hasOwnProperty(t)){var _=this.transactionMap[t];delete this.transactionMap[t];var n=e[T.C.HD_PRIMITIVE];n===T.C.PRI_ERROR_NAM?_.onErrorReceived(e):_ instanceof A?_.onMessageReceived(e)===!0&&(this.floorRequestMap[_.floorRequestId]=_):_ instanceof R?this.floorRequestMap.hasOwnProperty(_.floorRequestId)&&this.manageNotification(e):_ instanceof E?_.onMessageReceived(e):r("manageResponse(): FloorRequest/FloorRelease was expected")}else r("manageResponse(): not a response, ignored")},_.prototype.manageNotification=function(e){var t=e[T.C.HD_PRIMITIVE];if(t===T.C.PRI_FL_REQUEST_STATUS_NAM){var _=e[T.C.HD_ATTRIBUTES][T.C.ATT_FLOOR_REQUEST_INFORMATION_NAM][T.C.ATT_FL_REQUEST_ID_NAM];if(this.floorRequestMap.hasOwnProperty(_)){var r=this.floorRequestMap[_];r.onMessageReceived(e)===!1&&delete this.floorRequestMap[_]}}else t===T.C.PRI_FL_STATUS_NAM&&this.floorQuery&&this.floorQuery.onMessageReceived(e)},_.prototype.requestFloor=function(e,t,_,n,o){if(r("requestFloor() | floorIds: %o",t),!Array.isArray(t)||0===t.length)throw new TypeError("pArrayFloorIds must be an array with at least one element");var s=Math.floor(1e4*Math.random());_||(_=this.userId);var T=new A(e,_);this.transactionMap[s]=T;var i=this.messageFactory.createRequestFloor(s,t,_,n,o);return this.transport.send(i),T},_.prototype.release=function(e,t){r("release() | floorRequest: %o",t);var _=null;if(_=t instanceof A?t.floorRequestId:parseInt(t),null!==_&&_!==Number.NaN){var n=Math.floor(1e4*Math.random()),o=new R(e,_,this.userId);this.transactionMap[n]=o;var s=this.messageFactory.createReleaseFloor(n,_);this.transport.send(s)}},_.prototype.queryFloor=function(e){r("queryFloor() | floorIds: %o",e);var t=this;if(e.length>0){var _=Math.floor(1e4*Math.random()),n=new E(e);this.transactionMap[_]=n,this.floorQuery=n,n.on("floorGranted",function(e){t.emit("floorGranted",e)}),n.on("floorReleased",function(e){t.emit("floorReleased",e)});var o=this.messageFactory.createQueryFloor(_,e);this.transport.send(o)}},_.prototype.close=function(){r("close()"),this.closed||this.transport.close()}},{"./FloorQuery":2,"./FloorRelease":3,"./FloorRequest":4,"./MessageFactory":6,"./Transport":8,debug:14,events:9,util:13}],8:[function(e,t){function _(e,t){r("new | uri: %s",t),s.call(this);var _=this;this.closed=!1;try{this.ws=new A(t),this.ws.onopen=function(){_.emit("connected")},this.ws.onreconnect=function(){_.emit("connected")},this.ws.onmessage=function(e){_.onReceive(e)},this.ws.onclose=function(){_.emit("disconnected",_.closed)},this.ws.onerror=function(){n("WebSocket error")},this.messageFactory=e}catch(o){throw n("new | error thrown: %o",o),new i.NoWebSocketException}}t.exports=_;var r=e("debug")("JsFCP:Transport"),n=e("debug")("JsFCP:ERROR:Transport");n.log=console.warn.bind(console);var o=e("util"),s=e("events").EventEmitter,T=e("./MessageFactory"),i=e("./Exceptions"),A=e("websocketwrapper");o.inherits(_,s),_.prototype.isWebSocketReady=function(){return this.ws&&this.ws.readyState===this.ws.OPEN},_.prototype.send=function(e){var t=JSON.stringify(e);if(!this.isWebSocketReady())throw new i.NoWebSocketException;this.ws.send(t)},_.prototype.onReceive=function(e){var t;try{t=JSON.parse(e.data)}catch(_){return void r("onReceive() | received msg is not valid JSON")}r("onReceive() | json: %o",t);try{if(this.messageFactory.isValidHeaderFormat(t),!this.messageFactory.isMine(t))return;if(this.messageFactory.checkValidMessageFormat(t)){var n=t[T.C.HD_TRANSACTION_ID];0===n?this.emit("notification",t):this.emit("response",t)}}catch(_){throw _}},_.prototype.close=function(){this.closed=!0;try{this.ws.close()}catch(e){}}},{"./Exceptions":1,"./MessageFactory":6,debug:14,events:9,util:13,websocketwrapper:17}],9:[function(e,t){function _(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(e){return"function"==typeof e}function n(e){return"number"==typeof e}function o(e){return"object"==typeof e&&null!==e}function s(e){return void 0===e}t.exports=_,_.EventEmitter=_,_.prototype._events=void 0,_.prototype._maxListeners=void 0,_.defaultMaxListeners=10,_.prototype.setMaxListeners=function(e){if(!n(e)||0>e||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},_.prototype.emit=function(e){var t,_,n,T,i,A;if(this._events||(this._events={}),"error"===e&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;throw TypeError('Uncaught, unspecified "error" event.')}if(_=this._events[e],s(_))return!1;if(r(_))switch(arguments.length){case 1:_.call(this);break;case 2:_.call(this,arguments[1]);break;case 3:_.call(this,arguments[1],arguments[2]);break;default:for(n=arguments.length,T=new Array(n-1),i=1;n>i;i++)T[i-1]=arguments[i];_.apply(this,T)}else if(o(_)){for(n=arguments.length,T=new Array(n-1),i=1;n>i;i++)T[i-1]=arguments[i];for(A=_.slice(),n=A.length,i=0;n>i;i++)A[i].apply(this,T)}return!0},_.prototype.addListener=function(e,t){var n;if(!r(t))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,r(t.listener)?t.listener:t),this._events[e]?o(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,o(this._events[e])&&!this._events[e].warned){var n;n=s(this._maxListeners)?_.defaultMaxListeners:this._maxListeners,n&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())
}return this},_.prototype.on=_.prototype.addListener,_.prototype.once=function(e,t){function _(){this.removeListener(e,_),n||(n=!0,t.apply(this,arguments))}if(!r(t))throw TypeError("listener must be a function");var n=!1;return _.listener=t,this.on(e,_),this},_.prototype.removeListener=function(e,t){var _,n,s,T;if(!r(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(_=this._events[e],s=_.length,n=-1,_===t||r(_.listener)&&_.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(o(_)){for(T=s;T-->0;)if(_[T]===t||_[T].listener&&_[T].listener===t){n=T;break}if(0>n)return this;1===_.length?(_.length=0,delete this._events[e]):_.splice(n,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},_.prototype.removeAllListeners=function(e){var t,_;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(_=this._events[e],r(_))this.removeListener(e,_);else for(;_.length;)this.removeListener(e,_[_.length-1]);return delete this._events[e],this},_.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?r(this._events[e])?[this._events[e]]:this._events[e].slice():[]},_.listenerCount=function(e,t){var _;return _=e._events&&e._events[t]?r(e._events[t])?1:e._events[t].length:0}},{}],10:[function(e,t){t.exports="function"==typeof Object.create?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;var _=function(){};_.prototype=t.prototype,e.prototype=new _,e.prototype.constructor=e}},{}],11:[function(e,t){function _(){if(!s){s=!0;for(var e,t=o.length;t;){e=o,o=[];for(var _=-1;++_<t;)e[_]();t=o.length}s=!1}}function r(){}var n=t.exports={},o=[],s=!1;n.nextTick=function(e){o.push(e),s||setTimeout(_,0)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.on=r,n.addListener=r,n.once=r,n.off=r,n.removeListener=r,n.removeAllListeners=r,n.emit=r,n.binding=function(){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},{}],12:[function(e,t){t.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},{}],13:[function(e,t,_){(function(t,r){function n(e,t){var r={seen:[],stylize:s};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),I(t)?r.showHidden=t:t&&_._extend(r,t),O(r.showHidden)&&(r.showHidden=!1),O(r.depth)&&(r.depth=2),O(r.colors)&&(r.colors=!1),O(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=o),i(r,e,r.depth)}function o(e,t){var _=n.styles[t];return _?"["+n.colors[_][0]+"m"+e+"["+n.colors[_][1]+"m":e}function s(e){return e}function T(e){var t={};return e.forEach(function(e){t[e]=!0}),t}function i(e,t,r){if(e.customInspect&&t&&U(t.inspect)&&t.inspect!==_.inspect&&(!t.constructor||t.constructor.prototype!==t)){var n=t.inspect(r,e);return S(n)||(n=i(e,n,r)),n}var o=A(e,t);if(o)return o;var s=Object.keys(t),I=T(s);if(e.showHidden&&(s=Object.getOwnPropertyNames(t)),F(t)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return R(t);if(0===s.length){if(U(t)){var u=t.name?": "+t.name:"";return e.stylize("[Function"+u+"]","special")}if(h(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(p(t))return e.stylize(Date.prototype.toString.call(t),"date");if(F(t))return R(t)}var M="",l=!1,f=["{","}"];if(c(t)&&(l=!0,f=["[","]"]),U(t)){var O=t.name?": "+t.name:"";M=" [Function"+O+"]"}if(h(t)&&(M=" "+RegExp.prototype.toString.call(t)),p(t)&&(M=" "+Date.prototype.toUTCString.call(t)),F(t)&&(M=" "+R(t)),0===s.length&&(!l||0==t.length))return f[0]+M+f[1];if(0>r)return h(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special");e.seen.push(t);var L;return L=l?E(e,t,r,I,s):s.map(function(_){return a(e,t,r,I,_,l)}),e.seen.pop(),N(L,M,f)}function A(e,t){if(O(t))return e.stylize("undefined","undefined");if(S(t)){var _="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(_,"string")}return l(t)?e.stylize(""+t,"number"):I(t)?e.stylize(""+t,"boolean"):u(t)?e.stylize("null","null"):void 0}function R(e){return"["+Error.prototype.toString.call(e)+"]"}function E(e,t,_,r,n){for(var o=[],s=0,T=t.length;T>s;++s)o.push(v(t,String(s))?a(e,t,_,r,String(s),!0):"");return n.forEach(function(n){n.match(/^\d+$/)||o.push(a(e,t,_,r,n,!0))}),o}function a(e,t,_,r,n,o){var s,T,A;if(A=Object.getOwnPropertyDescriptor(t,n)||{value:t[n]},A.get?T=A.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):A.set&&(T=e.stylize("[Setter]","special")),v(r,n)||(s="["+n+"]"),T||(e.seen.indexOf(A.value)<0?(T=u(_)?i(e,A.value,null):i(e,A.value,_-1),T.indexOf("\n")>-1&&(T=o?T.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+T.split("\n").map(function(e){return"   "+e}).join("\n"))):T=e.stylize("[Circular]","special")),O(s)){if(o&&n.match(/^\d+$/))return T;s=JSON.stringify(""+n),s.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=e.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=e.stylize(s,"string"))}return s+": "+T}function N(e,t,_){var r=0,n=e.reduce(function(e,t){return r++,t.indexOf("\n")>=0&&r++,e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0);return n>60?_[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+_[1]:_[0]+t+" "+e.join(", ")+" "+_[1]}function c(e){return Array.isArray(e)}function I(e){return"boolean"==typeof e}function u(e){return null===e}function M(e){return null==e}function l(e){return"number"==typeof e}function S(e){return"string"==typeof e}function f(e){return"symbol"==typeof e}function O(e){return void 0===e}function h(e){return L(e)&&"[object RegExp]"===P(e)}function L(e){return"object"==typeof e&&null!==e}function p(e){return L(e)&&"[object Date]"===P(e)}function F(e){return L(e)&&("[object Error]"===P(e)||e instanceof Error)}function U(e){return"function"==typeof e}function d(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||"undefined"==typeof e}function P(e){return Object.prototype.toString.call(e)}function g(e){return 10>e?"0"+e.toString(10):e.toString(10)}function C(){var e=new Date,t=[g(e.getHours()),g(e.getMinutes()),g(e.getSeconds())].join(":");return[e.getDate(),b[e.getMonth()],t].join(" ")}function v(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var y=/%[sdj%]/g;_.format=function(e){if(!S(e)){for(var t=[],_=0;_<arguments.length;_++)t.push(n(arguments[_]));return t.join(" ")}for(var _=1,r=arguments,o=r.length,s=String(e).replace(y,function(e){if("%%"===e)return"%";if(_>=o)return e;switch(e){case"%s":return String(r[_++]);case"%d":return Number(r[_++]);case"%j":try{return JSON.stringify(r[_++])}catch(t){return"[Circular]"}default:return e}}),T=r[_];o>_;T=r[++_])s+=u(T)||!L(T)?" "+T:" "+n(T);return s},_.deprecate=function(e,n){function o(){if(!s){if(t.throwDeprecation)throw new Error(n);t.traceDeprecation?console.trace(n):console.error(n),s=!0}return e.apply(this,arguments)}if(O(r.process))return function(){return _.deprecate(e,n).apply(this,arguments)};if(t.noDeprecation===!0)return e;var s=!1;return o};var m,D={};_.debuglog=function(e){if(O(m)&&(m=t.env.NODE_DEBUG||""),e=e.toUpperCase(),!D[e])if(new RegExp("\\b"+e+"\\b","i").test(m)){var r=t.pid;D[e]=function(){var t=_.format.apply(_,arguments);console.error("%s %d: %s",e,r,t)}}else D[e]=function(){};return D[e]},_.inspect=n,n.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},n.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},_.isArray=c,_.isBoolean=I,_.isNull=u,_.isNullOrUndefined=M,_.isNumber=l,_.isString=S,_.isSymbol=f,_.isUndefined=O,_.isRegExp=h,_.isObject=L,_.isDate=p,_.isError=F,_.isFunction=U,_.isPrimitive=d,_.isBuffer=e("./support/isBuffer");var b=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];_.log=function(){console.log("%s - %s",C(),_.format.apply(_,arguments))},_.inherits=e("inherits"),_._extend=function(e,t){if(!t||!L(t))return e;for(var _=Object.keys(t),r=_.length;r--;)e[_[r]]=t[_[r]];return e}}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":12,_process:11,inherits:10}],14:[function(e,t,_){function r(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function n(){var e=arguments,t=this.useColors;if(e[0]=(t?"%c":"")+this.namespace+(t?" %c":" ")+e[0]+(t?"%c ":" ")+"+"+_.humanize(this.diff),!t)return e;var r="color: "+this.color;e=[e[0],r,"color: inherit"].concat(Array.prototype.slice.call(e,1));var n=0,o=0;return e[0].replace(/%[a-z%]/g,function(e){"%%"!==e&&(n++,"%c"===e&&(o=n))}),e.splice(o,0,r),e}function o(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function s(e){try{null==e?i.removeItem("debug"):i.debug=e}catch(t){}}function T(){var e;try{e=i.debug}catch(t){}return e}_=t.exports=e("./debug"),_.log=o,_.formatArgs=n,_.save=s,_.load=T,_.useColors=r;var i;i="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:window.localStorage,_.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],_.formatters.j=function(e){return JSON.stringify(e)},_.enable(T())},{"./debug":15}],15:[function(e,t,_){function r(){return _.colors[R++%_.colors.length]}function n(e){function t(){}function n(){var e=n,t=+new Date,o=t-(A||t);e.diff=o,e.prev=A,e.curr=t,A=t,null==e.useColors&&(e.useColors=_.useColors()),null==e.color&&e.useColors&&(e.color=r());var s=Array.prototype.slice.call(arguments);s[0]=_.coerce(s[0]),"string"!=typeof s[0]&&(s=["%o"].concat(s));var T=0;s[0]=s[0].replace(/%([a-z%])/g,function(t,r){if("%%"===t)return t;T++;var n=_.formatters[r];if("function"==typeof n){var o=s[T];t=n.call(e,o),s.splice(T,1),T--}return t}),"function"==typeof _.formatArgs&&(s=_.formatArgs.apply(e,s));var i=n.log||_.log||console.log.bind(console);i.apply(e,s)}t.enabled=!1,n.enabled=!0;var o=_.enabled(e)?n:t;return o.namespace=e,o}function o(e){_.save(e);for(var t=(e||"").split(/[\s,]+/),r=t.length,n=0;r>n;n++)t[n]&&(e=t[n].replace(/\*/g,".*?"),"-"===e[0]?_.skips.push(new RegExp("^"+e.substr(1)+"$")):_.names.push(new RegExp("^"+e+"$")))}function s(){_.enable("")}function T(e){var t,r;for(t=0,r=_.skips.length;r>t;t++)if(_.skips[t].test(e))return!1;for(t=0,r=_.names.length;r>t;t++)if(_.names[t].test(e))return!0;return!1}function i(e){return e instanceof Error?e.stack||e.message:e}_=t.exports=n,_.coerce=i,_.disable=s,_.enable=o,_.enabled=T,_.humanize=e("ms"),_.names=[],_.skips=[],_.formatters={};var A,R=0},{ms:16}],16:[function(e,t){function _(e){var t=/^((?:\d+)?\.?\d+) *(ms|seconds?|s|minutes?|m|hours?|h|days?|d|years?|y)?$/i.exec(e);if(t){var _=parseFloat(t[1]),r=(t[2]||"ms").toLowerCase();switch(r){case"years":case"year":case"y":return _*R;case"days":case"day":case"d":return _*A;case"hours":case"hour":case"h":return _*i;case"minutes":case"minute":case"m":return _*T;case"seconds":case"second":case"s":return _*s;case"ms":return _}}}function r(e){return e>=A?Math.round(e/A)+"d":e>=i?Math.round(e/i)+"h":e>=T?Math.round(e/T)+"m":e>=s?Math.round(e/s)+"s":e+"ms"}function n(e){return o(e,A,"day")||o(e,i,"hour")||o(e,T,"minute")||o(e,s,"second")||e+" ms"}function o(e,t,_){return t>e?void 0:1.5*t>e?Math.floor(e/t)+" "+_:Math.ceil(e/t)+" "+_+"s"}var s=1e3,T=60*s,i=60*T,A=24*i,R=365.25*A;t.exports=function(e,t){return t=t||{},"string"==typeof e?_(e):t["long"]?n(e):r(e)}},{}],17:[function(e,t){function _(e,t,_,T,A,R){s("new() | [url:%s, protocols:%s]",e,t);var E=this;this.createWebSocket=function(){this.ws=new i(e,t,_,T,A,R),this.ws.onopen=function(e){r.call(E,e)},this.ws.onerror=function(e){n.call(E,e)},this.ws.onclose=function(e){o.call(E,e)},this._onmessage&&(this.ws.onmessage=this._onmessage),this._binaryType&&(this.ws.binaryType=this._binaryType)},this.createWebSocket(),this.closed=!1,this.hasError=!1,this.isReconnecting=!1,this.reconnectionTimer=null,this.reconnectionDelay=2e3}function r(e){this.isReconnecting?(s("onreconnect()"),this.onreconnect?this.onreconnect(e):this.onopen&&this.onopen(e)):(s("onopen()"),this.onopen&&this.onopen(e))}function n(e){T("onerror() | event: %o",e),this.hasError=!0,this.onerror&&this.onerror(e)}function o(e){s('onclose() | [code:%s, reason:"%s", wasClean:%s]',e.code,e.reason,e.wasClean);var t=this;this.onclose&&this.onclose(e),this.closed||this.hasError||(this.hasError=!1,this.reconnectionDelay&&(this.reconnectionTimer=setTimeout(function(){s("reconnecting ..."),t.isReconnecting=!0,t.createWebSocket()},this.reconnectionDelay)))}t.exports=_;var s=e("debug")("WebSocketWrapper"),T=e("debug")("WebSocketWrapper:ERROR");T.log=console.warn.bind(console);var i=e("websocket").w3cwebsocket;Object.defineProperties(_.prototype,{url:{get:function(){return this.ws.url}},readyState:{get:function(){return this.ws.readyState}},protocol:{get:function(){return this.ws.protocol}},extensions:{get:function(){return this.ws.extensions}},bufferedAmount:{get:function(){return this.ws.bufferedAmount}},CONNECTING:{get:function(){return this.ws.CONNECTING}},OPEN:{get:function(){return this.ws.OPEN}},CLOSING:{get:function(){return this.ws.CLOSING}},CLOSED:{get:function(){return this.ws.CLOSED}},binaryType:{get:function(){return this.ws.binaryType},set:function(e){this._binaryType=e,this.ws.binaryType=e}},onmessage:{get:function(){return this.ws.onmessage},set:function(e){this._onmessage=e,this.ws.onmessage=e}}}),_.prototype.send=function(e){this.ws.send(e)},_.prototype.close=function(e,t){if(s("close() | [code:%s, reason:%s]",e,t),!this.closed)if(this.closed=!0,e=e||1e3,t=t||"user closure",this.onopen=null,this.onerror=null,this.onmessage=null,clearTimeout(this.reconnectionTimer),this.ws.readyState===this.ws.OPEN)try{this.ws.close(e,t)}catch(_){T("close() | error closing the WebSocket: %o",_)}else if(this.ws.readyState===this.ws.CONNECTING){var r=this.ws;r.onopen=function(){try{r.close(e,t)}catch(_){}}}},_.prototype.setReconnectionDelay=function(e){this.reconnectionDelay=e}},{debug:14,websocket:18}],18:[function(e,t){function _(e,t){var _;return _=t?new n(e,t):new n(e)}var r=function(){return this}(),n=r.WebSocket||r.MozWebSocket;t.exports={w3cwebsocket:n?_:null,version:e("./version")}},{"./version":19}],19:[function(e,t){t.exports=e("../package.json").version},{"../package.json":20}],20:[function(e,t){t.exports={name:"websocket",description:"Websocket Client & Server Library implementing the WebSocket protocol as specified in RFC 6455.",keywords:["websocket","websockets","socket","networking","comet","push","RFC-6455","realtime","server","client"],author:{name:"Brian McKelvey",email:"brian@worlize.com",url:"https://www.worlize.com/"},version:"1.0.17",repository:{type:"git",url:"https://github.com/theturtle32/WebSocket-Node.git"},homepage:"https://github.com/theturtle32/WebSocket-Node",engines:{node:">=0.8.0"},dependencies:{debug:"~2.1.0",nan:"~1.0.0","typedarray-to-buffer":"~3.0.0"},devDependencies:{"buffer-equal":"0.0.1",faucet:"0.0.1",gulp:"git+https://github.com/gulpjs/gulp.git#4.0","gulp-jshint":"^1.9.0","jshint-stylish":"^1.0.0",tape:"^3.0.0"},config:{verbose:!1},scripts:{install:"(node-gyp rebuild 2> builderror.log) || (exit 0)",test:"faucet test/unit",gulp:"gulp"},main:"index",directories:{lib:"./lib"},browser:"lib/browser.js",gitHead:"cda940b883aa884906ac13158fe514229a67f426",bugs:{url:"https://github.com/theturtle32/WebSocket-Node/issues"},_id:"websocket@1.0.17",_shasum:"8a572afc6ec120eb41473ca517d07d932f7b6a1c",_from:"websocket@>=1.0.17 <2.0.0",_npmVersion:"1.4.28",_npmUser:{name:"theturtle32",email:"brian@worlize.com"},maintainers:[{name:"theturtle32",email:"brian@worlize.com"}],dist:{shasum:"8a572afc6ec120eb41473ca517d07d932f7b6a1c",tarball:"http://registry.npmjs.org/websocket/-/websocket-1.0.17.tgz"},_resolved:"https://registry.npmjs.org/websocket/-/websocket-1.0.17.tgz",readme:"ERROR: No README data found!"}},{}]},{},[5])(5)});